"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[645],{2038:function(W,u,b){b.d(u,{"$r":function(){return aU},Bv:function(){return bm},Ie:function(){return bf},JZ:function(){return bj},Rv:function(){return bg},TI:function(){return ai},Th:function(){return ba},UX:function(){return aX},VL:function(){return w},Y9:function(){return bd},ZM:function(){return aV},ZX:function(){return i},"a$":function(){return be},bO:function(){return B},e6:function(){return bb},ex:function(){return H},kP:function(){return bc},lW:function(){return am},oo:function(){return au},qm:function(){return g},ud:function(){return as},wn:function(){return I},xE:function(){return z}});var X,Y,k=b(1576),d=b(1680),e=b(8942),Z=b(1034),$=b(6679),a=b(7368);/*!
 * @pixi/core - v6.4.2
 * Compiled Thu, 02 Jun 2022 15:39:26 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ k.X.PREFER_ENV=e.tq.any?d.Vi.WEBGL:d.Vi.WEBGL2,k.X.STRICT_TEXTURE_CACHE=!1;var l=[];function v(a,f){if(!a)return null;var d="";if("string"==typeof a){var e=/\.(\w{3,4})(?:$|\?|#)/i.exec(a);e&&(d=e[1].toLowerCase())}for(var b=l.length-1;b>=0;--b){var c=l[b];if(c.test&&c.test(a,d))return new c(a,f)}throw Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */ var _=function(a,b){return(_=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])})(a,b)};function aa(b,a){function c(){this.constructor=b}_(b,a),b.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)}var ab=function(){return(ab=Object.assign||function(d){for(var a,e=arguments,b=1,f=arguments.length;b<f;b++)for(var c in a=e[b])Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);return d}).apply(this,arguments)},f=function(){function a(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this._width=a,this._height=b,this.destroyed=!1,this.internal=!1,this.onResize=new Z.R("setRealSize"),this.onUpdate=new Z.R("update"),this.onError=new Z.R("onError")}return a.prototype.bind=function(a){this.onResize.add(a),this.onUpdate.add(a),this.onError.add(a),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},a.prototype.unbind=function(a){this.onResize.remove(a),this.onUpdate.remove(a),this.onError.remove(a)},a.prototype.resize=function(a,b){(a!==this._width||b!==this._height)&&(this._width=a,this._height=b,this.onResize.emit(a,b))},Object.defineProperty(a.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),a.prototype.update=function(){this.destroyed||this.onUpdate.emit()},a.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),a.prototype.style=function(a,b,c){return!1},a.prototype.dispose=function(){},a.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},a.test=function(a,b){return!1},a}(),g=function(b){function a(f,g){var a=this,c=g||{},d=c.width,e=c.height;if(!d||!e)throw Error("BufferResource width or height invalid");return(a=b.call(this,d,e)||this).data=f,a}return aa(a,b),a.prototype.upload=function(g,a,b){var c=g.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.alphaMode===d.iw.UNPACK);var e=a.realWidth,f=a.realHeight;return b.width===e&&b.height===f?c.texSubImage2D(a.target,0,0,0,e,f,a.format,b.type,this.data):(b.width=e,b.height=f,c.texImage2D(a.target,0,b.internalFormat,e,f,0,a.format,b.type,this.data)),!0},a.prototype.dispose=function(){this.data=null},a.test=function(a){return a instanceof Float32Array||a instanceof Uint8Array||a instanceof Uint32Array},a}(f),ac={scaleMode:d.aH.NEAREST,format:d.I2.RGBA,alphaMode:d.iw.NPM},w=function(b){function a(g,c){void 0===g&&(g=null),void 0===c&&(c=null);var a=b.call(this)||this,h=(c=c||{}).alphaMode,i=c.mipmap,j=c.anisotropicLevel,l=c.scaleMode,m=c.width,n=c.height,o=c.wrapMode,p=c.format,q=c.type,r=c.target,s=c.resolution,t=c.resourceOptions;return!g||g instanceof f||((g=v(g,t)).internal=!0),a.resolution=s||k.X.RESOLUTION,a.width=Math.round((m||0)*a.resolution)/a.resolution,a.height=Math.round((n||0)*a.resolution)/a.resolution,a._mipmap=void 0!==i?i:k.X.MIPMAP_TEXTURES,a.anisotropicLevel=void 0!==j?j:k.X.ANISOTROPIC_LEVEL,a._wrapMode=o||k.X.WRAP_MODE,a._scaleMode=void 0!==l?l:k.X.SCALE_MODE,a.format=p||d.I2.RGBA,a.type=q||d.vK.UNSIGNED_BYTE,a.target=r||d.sp.TEXTURE_2D,a.alphaMode=void 0!==h?h:d.iw.UNPACK,a.uid=(0,e.hQ)(),a.touched=0,a.isPowerOfTwo=!1,a._refreshPOT(),a._glTextures={},a.dirtyId=0,a.dirtyStyleId=0,a.cacheId=null,a.valid=m>0&&n>0,a.textureCacheIds=[],a.destroyed=!1,a.resource=null,a._batchEnabled=0,a._batchLocation=0,a.parentTextureArray=null,a.setResource(g),a}return aa(a,b),Object.defineProperty(a.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"mipmap",{get:function(){return this._mipmap},set:function(a){this._mipmap!==a&&(this._mipmap=a,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(a){this._scaleMode!==a&&(this._scaleMode=a,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(a){this._wrapMode!==a&&(this._wrapMode=a,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),a.prototype.setStyle=function(a,b){var c;return void 0!==a&&a!==this.scaleMode&&(this.scaleMode=a,c=!0),void 0!==b&&b!==this.mipmap&&(this.mipmap=b,c=!0),c&&this.dirtyStyleId++,this},a.prototype.setSize=function(b,c,a){return a=a||this.resolution,this.setRealSize(b*a,c*a,a)},a.prototype.setRealSize=function(a,b,c){return this.resolution=c||this.resolution,this.width=Math.round(a)/this.resolution,this.height=Math.round(b)/this.resolution,this._refreshPOT(),this.update(),this},a.prototype._refreshPOT=function(){this.isPowerOfTwo=(0,e.wv)(this.realWidth)&&(0,e.wv)(this.realHeight)},a.prototype.setResolution=function(a){var b=this.resolution;return b===a||(this.resolution=a,this.valid&&(this.width=Math.round(this.width*b)/a,this.height=Math.round(this.height*b)/a,this.emit("update",this)),this._refreshPOT()),this},a.prototype.setResource=function(a){if(this.resource===a)return this;if(this.resource)throw Error("Resource can be set only once");return a.bind(this),this.resource=a,this},a.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},a.prototype.onError=function(a){this.emit("error",this,a)},a.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete e.V8[this.cacheId],delete e.kN[this.cacheId],this.cacheId=null),this.dispose(),a.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},a.prototype.dispose=function(){this.emit("dispose",this)},a.prototype.castToBaseTexture=function(){return this},a.from=function(b,f,g){void 0===g&&(g=k.X.STRICT_TEXTURE_CACHE);var h="string"==typeof b,c=null;if(h)c=b;else{if(!b._pixiId){var i=f&&f.pixiIdPrefix||"pixiid";b._pixiId=i+"_"+(0,e.hQ)()}c=b._pixiId}var d=e.V8[c];if(h&&g&&!d)throw Error('The cacheId "'+c+'" does not exist in BaseTextureCache.');return d||((d=new a(b,f)).cacheId=c,a.addToCache(d,c)),d},a.fromBuffer=function(b,c,e,f){b=b||new Float32Array(c*e*4);var h=new g(b,{width:c,height:e}),i=b instanceof Float32Array?d.vK.FLOAT:d.vK.UNSIGNED_BYTE;return new a(h,Object.assign(ac,f||{width:c,height:e,type:i}))},a.addToCache=function(b,a){a&&(-1===b.textureCacheIds.indexOf(a)&&b.textureCacheIds.push(a),e.V8[a]&&console.warn("BaseTexture added to the cache with an id ["+a+"] that already had an entry"),e.V8[a]=b)},a.removeFromCache=function(a){if("string"==typeof a){var b=e.V8[a];if(b){var d=b.textureCacheIds.indexOf(a);return d> -1&&b.textureCacheIds.splice(d,1),delete e.V8[a],b}}else if(a&&a.textureCacheIds){for(var c=0;c<a.textureCacheIds.length;++c)delete e.V8[a.textureCacheIds[c]];return a.textureCacheIds.length=0,a}return null},a._globalBatch=0,a}(e.vp),h=function(b){function a(c,f){var a=this,d=f||{},g=d.width,h=d.height;(a=b.call(this,g,h)||this).items=[],a.itemDirtyIds=[];for(var e=0;e<c;e++){var i=new w;a.items.push(i),a.itemDirtyIds.push(-2)}return a.length=c,a._load=null,a.baseTexture=null,a}return aa(a,b),a.prototype.initFromArray=function(b,c){for(var a=0;a<this.length;a++)b[a]&&(b[a].castToBaseTexture?this.addBaseTextureAt(b[a].castToBaseTexture(),a):b[a]instanceof f?this.addResourceAt(b[a],a):this.addResourceAt(v(b[a],c),a))},a.prototype.dispose=function(){for(var a=0,b=this.length;a<b;a++)this.items[a].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},a.prototype.addResourceAt=function(a,b){if(!this.items[b])throw Error("Index "+b+" is out of bounds");return a.valid&&!this.valid&&this.resize(a.width,a.height),this.items[b].setResource(a),this},a.prototype.bind=function(a){if(null!==this.baseTexture)throw Error("Only one base texture per TextureArray is allowed");b.prototype.bind.call(this,a);for(var c=0;c<this.length;c++)this.items[c].parentTextureArray=a,this.items[c].on("update",a.update,a)},a.prototype.unbind=function(c){b.prototype.unbind.call(this,c);for(var a=0;a<this.length;a++)this.items[a].parentTextureArray=null,this.items[a].off("update",c.update,c)},a.prototype.load=function(){var b=this;if(this._load)return this._load;var a=this.items.map(function(a){return a.resource}).filter(function(a){return a}).map(function(a){return a.load()});return this._load=Promise.all(a).then(function(){var a=b.items[0],c=a.realWidth,d=a.realHeight;return b.resize(c,d),Promise.resolve(b)}),this._load},a}(f),m=function(b){function a(a,f){var c,d,e=this,g=f||{},h=g.width,i=g.height;return Array.isArray(a)?(c=a,d=a.length):d=a,e=b.call(this,d,{width:h,height:i})||this,c&&e.initFromArray(c,f),e}return aa(a,b),a.prototype.addBaseTextureAt=function(a,b){if(a.resource)this.addResourceAt(a.resource,b);else throw Error("ArrayResource does not support RenderTexture");return this},a.prototype.bind=function(a){b.prototype.bind.call(this,a),a.target=d.sp.TEXTURE_2D_ARRAY},a.prototype.upload=function(h,e,c){var f=this.length,g=this.itemDirtyIds,i=this.items,d=h.gl;c.dirtyId<0&&d.texImage3D(d.TEXTURE_2D_ARRAY,0,c.internalFormat,this._width,this._height,f,0,e.format,c.type,null);for(var a=0;a<f;a++){var b=i[a];g[a]<b.dirtyId&&(g[a]=b.dirtyId,b.valid&&d.texSubImage3D(d.TEXTURE_2D_ARRAY,0,0,0,a,b.resource.width,b.resource.height,1,e.format,c.type,b.resource.source))}return!0},a}(h),c=function(b){function a(d){var c=this,a=d,e=a.naturalWidth||a.videoWidth||a.width,f=a.naturalHeight||a.videoHeight||a.height;return(c=b.call(this,e,f)||this).source=d,c.noSubImage=!1,c}return aa(a,b),a.crossOrigin=function(b,c,a){void 0===a&&0!==c.indexOf("data:")?b.crossOrigin=(0,e.Qq)(c):!1!==a&&(b.crossOrigin="string"==typeof a?a:"anonymous")},a.prototype.upload=function(h,b,c,a){var e=h.gl,f=b.realWidth,g=b.realHeight;if((a=a||this.source)instanceof HTMLImageElement){if(!a.complete||0===a.naturalWidth)return!1}else if(a instanceof HTMLVideoElement&&a.readyState<=1)return!1;return e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.alphaMode===d.iw.UNPACK),this.noSubImage||b.target!==e.TEXTURE_2D||c.width!==f||c.height!==g?(c.width=f,c.height=g,e.texImage2D(b.target,0,c.internalFormat,b.format,c.type,a)):e.texSubImage2D(e.TEXTURE_2D,0,0,0,b.format,c.type,a),!0},a.prototype.update=function(){if(!this.destroyed){var a=this.source,c=a.naturalWidth||a.videoWidth||a.width,d=a.naturalHeight||a.videoHeight||a.height;this.resize(c,d),b.prototype.update.call(this)}},a.prototype.dispose=function(){this.source=null},a}(f),n=function(b){function a(a){return b.call(this,a)||this}return aa(a,b),a.test=function(a){var b=globalThis.OffscreenCanvas;return!!b&&a instanceof b||globalThis.HTMLCanvasElement&&a instanceof HTMLCanvasElement},a}(c),o=function(b){function a(e,h){var c=this,f=h||{},i=f.width,j=f.height,k=f.autoLoad,l=f.linkBaseTexture;if(e&&e.length!==a.SIDES)throw Error("Invalid length. Got "+e.length+", expected 6");c=b.call(this,6,{width:i,height:j})||this;for(var g=0;g<a.SIDES;g++)c.items[g].target=d.sp.TEXTURE_CUBE_MAP_POSITIVE_X+g;return c.linkBaseTexture=!1!==l,e&&c.initFromArray(e,h),!1!==k&&c.load(),c}return aa(a,b),a.prototype.bind=function(a){b.prototype.bind.call(this,a),a.target=d.sp.TEXTURE_CUBE_MAP},a.prototype.addBaseTextureAt=function(a,b,c){if(!this.items[b])throw Error("Index "+b+" is out of bounds");if(!this.linkBaseTexture||a.parentTextureArray||Object.keys(a._glTextures).length>0){if(a.resource)this.addResourceAt(a.resource,b);else throw Error("CubeResource does not support copying of renderTexture.")}else a.target=d.sp.TEXTURE_CUBE_MAP_POSITIVE_X+b,a.parentTextureArray=this.baseTexture,this.items[b]=a;return a.valid&&!this.valid&&this.resize(a.realWidth,a.realHeight),this.items[b]=a,this},a.prototype.upload=function(g,e,f){for(var d=this.itemDirtyIds,b=0;b<a.SIDES;b++){var c=this.items[b];d[b]<c.dirtyId&&(c.valid&&c.resource?(c.resource.upload(g,c,f),d[b]=c.dirtyId):d[b]< -1&&(g.gl.texImage2D(c.target,0,f.internalFormat,e.realWidth,e.realHeight,0,e.format,f.type,null),d[b]=-1))}return!0},a.test=function(b){return Array.isArray(b)&&b.length===a.SIDES},a.SIDES=6,a}(h),p=function(b){function a(e,d){var a=this;if(d=d||{},!(e instanceof HTMLImageElement)){var f=new Image;c.crossOrigin(f,e,d.crossorigin),f.src=e,e=f}return a=b.call(this,e)||this,!e.complete&&a._width&&a._height&&(a._width=0,a._height=0),a.url=e.src,a._process=null,a.preserveBitmap=!1,a.createBitmap=(void 0!==d.createBitmap?d.createBitmap:k.X.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,a.alphaMode="number"==typeof d.alphaMode?d.alphaMode:null,a.bitmap=null,a._load=null,!1!==d.autoLoad&&a.load(),a}return aa(a,b),a.prototype.load=function(a){var b=this;return this._load||(void 0!==a&&(this.createBitmap=a),this._load=new Promise(function(d,e){var a=b.source;b.url=a.src;var c=function(){!b.destroyed&&(a.onload=null,a.onerror=null,b.resize(a.width,a.height),b._load=null,b.createBitmap?d(b.process()):d(b))};a.complete&&a.src?c():(a.onload=c,a.onerror=function(a){e(a),b.onError.emit(a)})})),this._load},a.prototype.process=function(){var c=this,a=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var e=globalThis.createImageBitmap,b=!a.crossOrigin||"anonymous"===a.crossOrigin;return this._process=fetch(a.src,{mode:b?"cors":"no-cors"}).then(function(a){return a.blob()}).then(function(b){return e(b,0,0,a.width,a.height,{premultiplyAlpha:c.alphaMode===d.iw.UNPACK?"premultiply":"none"})}).then(function(a){return c.destroyed?Promise.reject():(c.bitmap=a,c.update(),c._process=null,Promise.resolve(c))}),this._process},a.prototype.upload=function(d,a,c){if("number"==typeof this.alphaMode&&(a.alphaMode=this.alphaMode),!this.createBitmap)return b.prototype.upload.call(this,d,a,c);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(b.prototype.upload.call(this,d,a,c,this.bitmap),!this.preserveBitmap){var e=!0,f=a._glTextures;for(var h in f){var g=f[h];if(g!==c&&g.dirtyId!==a.dirtyId){e=!1;break}}e&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},a.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,b.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},a.test=function(a){return"string"==typeof a||a instanceof HTMLImageElement},a}(c),q=function(b){function a(d,c){var a=this;return c=c||{},(a=b.call(this,document.createElement("canvas"))||this)._width=0,a._height=0,a.svg=d,a.scale=c.scale||1,a._overrideWidth=c.width,a._overrideHeight=c.height,a._resolve=null,a._crossorigin=c.crossorigin,a._load=null,!1!==c.autoLoad&&a.load(),a}return aa(a,b),a.prototype.load=function(){var b=this;return this._load||(this._load=new Promise(function(c){if(b._resolve=function(){b.resize(b.source.width,b.source.height),c(b)},a.SVG_XML.test(b.svg.trim())){if(!btoa)throw Error("Your browser doesn't support base64 conversions.");b.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(b.svg)))}b._loadSvg()})),this._load},a.prototype._loadSvg=function(){var b=this,a=new Image;c.crossOrigin(a,this.svg,this._crossorigin),a.src=this.svg,a.onerror=function(c){b._resolve&&(a.onerror=null,b.onError.emit(c))},a.onload=function(){if(b._resolve){var c=a.width,d=a.height;if(!c||!d)throw Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var f=c*b.scale,g=d*b.scale;(b._overrideWidth||b._overrideHeight)&&(f=b._overrideWidth||b._overrideHeight/d*c,g=b._overrideHeight||b._overrideWidth/c*d),f=Math.round(f),g=Math.round(g);var h=b.source;h.width=f,h.height=g,h._pixiId="canvas_"+(0,e.hQ)(),h.getContext("2d").drawImage(a,0,0,c,d,0,0,f,g),b._resolve(),b._resolve=null}}},a.getSize=function(d){var b=a.SVG_SIZE.exec(d),c={};return b&&(c[b[1]]=Math.round(parseFloat(b[3])),c[b[5]]=Math.round(parseFloat(b[7]))),c},a.prototype.dispose=function(){b.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},a.test=function(b,c){return"svg"===c||"string"==typeof b&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(b)||"string"==typeof b&&a.SVG_XML.test(b)},a.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,a.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,a}(c),r=function(b){function a(e,f){var d=this;if(f=f||{},!(e instanceof HTMLVideoElement)){var g=document.createElement("video");g.setAttribute("preload","auto"),g.setAttribute("webkit-playsinline",""),g.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]);var o=e[0].src||e[0];c.crossOrigin(g,o,f.crossorigin);for(var h=0;h<e.length;++h){var i=document.createElement("source"),l=e[h],j=l.src,k=l.mime,m=(j=j||e[h]).split("?").shift().toLowerCase(),n=m.slice(m.lastIndexOf(".")+1);k=k||a.MIME_TYPES[n]||"video/"+n,i.src=j,i.type=k,g.appendChild(i)}e=g}return(d=b.call(this,e)||this).noSubImage=!0,d._autoUpdate=!0,d._isConnectedToTicker=!1,d._updateFPS=f.updateFPS||0,d._msToNextUpdate=0,d.autoPlay=!1!==f.autoPlay,d._load=null,d._resolve=null,d._onCanPlay=d._onCanPlay.bind(d),d._onError=d._onError.bind(d),!1!==f.autoLoad&&d.load(),d}return aa(a,b),a.prototype.update=function(c){if(!this.destroyed){var a=$.vB.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-a),(!this._updateFPS||this._msToNextUpdate<=0)&&(b.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},a.prototype.load=function(){var b=this;if(this._load)return this._load;var a=this.source;return(a.readyState===a.HAVE_ENOUGH_DATA||a.readyState===a.HAVE_FUTURE_DATA)&&a.width&&a.height&&(a.complete=!0),a.addEventListener("play",this._onPlayStart.bind(this)),a.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(a.addEventListener("canplay",this._onCanPlay),a.addEventListener("canplaythrough",this._onCanPlay),a.addEventListener("error",this._onError,!0)),this._load=new Promise(function(c){b.valid?c(b):(b._resolve=c,a.load())}),this._load},a.prototype._onError=function(a){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(a)},a.prototype._isSourcePlaying=function(){var a=this.source;return a.currentTime>0&& !1===a.paused&& !1===a.ended&&a.readyState>2},a.prototype._isSourceReady=function(){var a=this.source;return 3===a.readyState||4===a.readyState},a.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&($.vB.shared.add(this.update,this),this._isConnectedToTicker=!0)},a.prototype._onPlayStop=function(){this._isConnectedToTicker&&($.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1)},a.prototype._onCanPlay=function(){var a=this.source;a.removeEventListener("canplay",this._onCanPlay),a.removeEventListener("canplaythrough",this._onCanPlay);var b=this.valid;this.resize(a.videoWidth,a.videoHeight),!b&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&a.play()},a.prototype.dispose=function(){this._isConnectedToTicker&&($.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1);var a=this.source;a&&(a.removeEventListener("error",this._onError,!0),a.pause(),a.src="",a.load()),b.prototype.dispose.call(this)},Object.defineProperty(a.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(a){a!==this._autoUpdate&&(this._autoUpdate=a,!this._autoUpdate&&this._isConnectedToTicker?($.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&($.vB.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(a){a!==this._updateFPS&&(this._updateFPS=a)},enumerable:!1,configurable:!0}),a.test=function(b,c){return globalThis.HTMLVideoElement&&b instanceof HTMLVideoElement||a.TYPES.indexOf(c)> -1},a.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],a.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},a}(c),s=function(b){function a(a){return b.call(this,a)||this}return aa(a,b),a.test=function(a){return!!globalThis.createImageBitmap&&a instanceof ImageBitmap},a}(c);l.push(p,s,n,r,q,g,o,m);var x={__proto__:null,Resource:f,BaseImageResource:c,INSTALLED:l,autoDetectResource:v,AbstractMultiResource:h,ArrayResource:m,BufferResource:g,CanvasResource:n,CubeResource:o,ImageResource:p,SVGResource:q,VideoResource:r,ImageBitmapResource:s},ad=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}return aa(a,b),a.prototype.upload=function(g,a,b){var c=g.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.alphaMode===d.iw.UNPACK);var e=a.realWidth,f=a.realHeight;return b.width===e&&b.height===f?c.texSubImage2D(a.target,0,0,0,e,f,a.format,b.type,this.data):(b.width=e,b.height=f,c.texImage2D(a.target,0,b.internalFormat,e,f,0,a.format,b.type,this.data)),!0},a}(g),ae=function(){function a(a,b){this.width=Math.round(a||100),this.height=Math.round(b||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Z.R("disposeFramebuffer"),this.multisample=d.G5.NONE}return Object.defineProperty(a.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),a.prototype.addColorTexture=function(a,b){return void 0===a&&(a=0),this.colorTextures[a]=b||new w(null,{scaleMode:d.aH.NEAREST,resolution:1,mipmap:d.WB.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},a.prototype.addDepthTexture=function(a){return this.depthTexture=a||new w(new ad(null,{width:this.width,height:this.height}),{scaleMode:d.aH.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:d.WB.OFF,format:d.I2.DEPTH_COMPONENT,type:d.vK.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},a.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},a.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},a.prototype.resize=function(a,b){if(a=Math.round(a),b=Math.round(b),a!==this.width||b!==this.height){this.width=a,this.height=b,this.dirtyId++,this.dirtySize++;for(var d=0;d<this.colorTextures.length;d++){var e=this.colorTextures[d],c=e.resolution;e.setSize(a/c,b/c)}if(this.depthTexture){var c=this.depthTexture.resolution;this.depthTexture.setSize(a/c,b/c)}}},a.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},a.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},a}(),af=function(b){function a(a){void 0===a&&(a={});var c=this;if("number"==typeof a){var e=arguments[0],f=arguments[1],g=arguments[2],h=arguments[3];a={width:e,height:f,scaleMode:g,resolution:h}}return a.width=a.width||100,a.height=a.height||100,a.multisample=void 0!==a.multisample?a.multisample:d.G5.NONE,(c=b.call(this,null,a)||this).mipmap=d.WB.OFF,c.valid=!0,c.clearColor=[0,0,0,0],c.framebuffer=new ae(c.realWidth,c.realHeight).addColorTexture(0,c),c.framebuffer.multisample=a.multisample,c.maskStack=[],c.filterStack=[{}],c}return aa(a,b),a.prototype.resize=function(a,b){this.framebuffer.resize(a*this.resolution,b*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},a.prototype.dispose=function(){this.framebuffer.dispose(),b.prototype.dispose.call(this)},a.prototype.destroy=function(){b.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},a}(w),y=function(){function b(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return b.prototype.set=function(c,j,b){var d=j.width,e=j.height;if(b){var f=c.width/2/d,g=c.height/2/e,h=c.x/d+f,i=c.y/e+g;b=a.Lv.add(b,a.Lv.NW),this.x0=h+f*a.Lv.uX(b),this.y0=i+g*a.Lv.uY(b),b=a.Lv.add(b,2),this.x1=h+f*a.Lv.uX(b),this.y1=i+g*a.Lv.uY(b),b=a.Lv.add(b,2),this.x2=h+f*a.Lv.uX(b),this.y2=i+g*a.Lv.uY(b),b=a.Lv.add(b,2),this.x3=h+f*a.Lv.uX(b),this.y3=i+g*a.Lv.uY(b)}else this.x0=c.x/d,this.y0=c.y/e,this.x1=(c.x+c.width)/d,this.y1=c.y/e,this.x2=(c.x+c.width)/d,this.y2=(c.y+c.height)/e,this.x3=c.x/d,this.y3=(c.y+c.height)/e;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},b.prototype.toString=function(){return"[@pixi/core:TextureUvs "+("x0="+this.x0+" y0=")+this.y0+" "+("x1="+this.x1+" y1="+this.y1+" x2=")+this.x2+" "+("y2="+this.y2+" x3="+this.x3)+" y3="+this.y3+"]"},b}(),ag=new y;function ah(a){a.destroy=function(){},a.on=function(){},a.once=function(){},a.emit=function(){}}var z=function(c){function b(e,f,i,j,h,g){var d=c.call(this)||this;if(d.noFrame=!1,f||(d.noFrame=!0,f=new a.Ae(0,0,1,1)),e instanceof b&&(e=e.baseTexture),d.baseTexture=e,d._frame=f,d.trim=j,d.valid=!1,d._uvs=ag,d.uvMatrix=null,d.orig=i||f,d._rotate=Number(h||0),!0===h)d._rotate=2;else if(d._rotate%2!=0)throw Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return d.defaultAnchor=g?new a.E9(g.x,g.y):new a.E9(0,0),d._updateID=0,d.textureCacheIds=[],e.valid?d.noFrame?e.valid&&d.onBaseTextureUpdated(e):d.frame=f:e.once("loaded",d.onBaseTextureUpdated,d),d.noFrame&&e.on("update",d.onBaseTextureUpdated,d),d}return aa(b,c),b.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},b.prototype.onBaseTextureUpdated=function(a){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=a.width,this._frame.height=a.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},b.prototype.destroy=function(c){if(this.baseTexture){if(c){var a=this.baseTexture.resource;a&&a.url&&e.kN[a.url]&&b.removeFromCache(a.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,b.removeFromCache(this),this.textureCacheIds=null},b.prototype.clone=function(){var a=this._frame.clone(),d=this._frame===this.orig?a:this.orig.clone(),c=new b(this.baseTexture,!this.noFrame&&a,d,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(c._frame=a),c},b.prototype.updateUvs=function(){this._uvs===ag&&(this._uvs=new y),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},b.from=function(a,c,g){void 0===c&&(c={}),void 0===g&&(g=k.X.STRICT_TEXTURE_CACHE);var i="string"==typeof a,d=null;if(i)d=a;else if(a instanceof w){if(!a.cacheId){var h=c&&c.pixiIdPrefix||"pixiid";a.cacheId=h+"-"+(0,e.hQ)(),w.addToCache(a,a.cacheId)}d=a.cacheId}else{if(!a._pixiId){var h=c&&c.pixiIdPrefix||"pixiid";a._pixiId=h+"_"+(0,e.hQ)()}d=a._pixiId}var f=e.kN[d];if(i&&g&&!f)throw Error('The cacheId "'+d+'" does not exist in TextureCache.');return f||a instanceof w?!f&&a instanceof w&&(f=new b(a),b.addToCache(f,d)):(c.resolution||(c.resolution=(0,e.fL)(a)),(f=new b(new w(a,c))).baseTexture.cacheId=d,w.addToCache(f.baseTexture,d),b.addToCache(f,d)),f},b.fromURL=function(d,a){var e=Object.assign({autoLoad:!1},null==a?void 0:a.resourceOptions),c=b.from(d,Object.assign({resourceOptions:e},a),!1),f=c.baseTexture.resource;return c.baseTexture.valid?Promise.resolve(c):f.load().then(function(){return Promise.resolve(c)})},b.fromBuffer=function(a,c,d,e){return new b(w.fromBuffer(a,c,d,e))},b.fromLoader=function(h,a,d,i){var f=new w(h,Object.assign({scaleMode:k.X.SCALE_MODE,resolution:(0,e.fL)(a)},i)),g=f.resource;g instanceof p&&(g.url=a);var c=new b(f);return(d||(d=a),w.addToCache(c.baseTexture,d),b.addToCache(c,d),d!==a&&(w.addToCache(c.baseTexture,a),b.addToCache(c,a)),c.baseTexture.valid)?Promise.resolve(c):new Promise(function(a){c.baseTexture.once("loaded",function(){return a(c)})})},b.addToCache=function(b,a){a&&(-1===b.textureCacheIds.indexOf(a)&&b.textureCacheIds.push(a),e.kN[a]&&console.warn("Texture added to the cache with an id ["+a+"] that already had an entry"),e.kN[a]=b)},b.removeFromCache=function(a){if("string"==typeof a){var b=e.kN[a];if(b){var d=b.textureCacheIds.indexOf(a);return d> -1&&b.textureCacheIds.splice(d,1),delete e.kN[a],b}}else if(a&&a.textureCacheIds){for(var c=0;c<a.textureCacheIds.length;++c)e.kN[a.textureCacheIds[c]]===a&&delete e.kN[a.textureCacheIds[c]];return a.textureCacheIds.length=0,a}return null},Object.defineProperty(b.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"frame",{get:function(){return this._frame},set:function(a){this._frame=a,this.noFrame=!1;var d=a.x,e=a.y,b=a.width,c=a.height,f=d+b>this.baseTexture.width,g=e+c>this.baseTexture.height;if(f||g){var i,h=f&&g?"and":"or";throw Error("Texture Error: frame does not fit inside the base Texture dimensions: "+("X: "+d+" + "+b+" = "+(d+b)+" > "+this.baseTexture.width+" "+h)+" "+("Y: "+e+" + "+c+" = "+(e+c)+" > ")+this.baseTexture.height)}this.valid=b&&c&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=a),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"rotate",{get:function(){return this._rotate},set:function(a){this._rotate=a,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),b.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(b,"EMPTY",{get:function(){return b._EMPTY||(b._EMPTY=new b(new w),ah(b._EMPTY),ah(b._EMPTY.baseTexture)),b._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(b,"WHITE",{get:function(){if(!b._WHITE){var a=document.createElement("canvas"),c=a.getContext("2d");a.width=16,a.height=16,c.fillStyle="white",c.fillRect(0,0,16,16),b._WHITE=new b(new w(new n(a))),ah(b._WHITE),ah(b._WHITE.baseTexture)}return b._WHITE},enumerable:!1,configurable:!0}),b}(e.vp),ai=function(b){function a(c,d){var a=b.call(this,c,d)||this;return a.valid=!0,a.filterFrame=null,a.filterPoolKey=null,a.updateUvs(),a}return aa(a,b),Object.defineProperty(a.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(a){this.framebuffer.multisample=a},enumerable:!1,configurable:!0}),a.prototype.resize=function(e,f,b){void 0===b&&(b=!0);var a=this.baseTexture.resolution,c=Math.round(e*a)/a,d=Math.round(f*a)/a;this.valid=c>0&&d>0,this._frame.width=this.orig.width=c,this._frame.height=this.orig.height=d,b&&this.baseTexture.resize(c,d),this.updateUvs()},a.prototype.setResolution=function(b){var a=this.baseTexture;a.resolution!==b&&(a.setResolution(b),this.resize(a.width,a.height,!1))},a.create=function(b){for(var f=arguments,c=[],d=1;d<arguments.length;d++)c[d-1]=f[d];return"number"==typeof b&&((0,e.a1)("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),b={width:b,height:c[0],scaleMode:c[1],resolution:c[2]}),new a(new af(b))},a}(z),aj=function(){function a(a){this.texturePool={},this.textureOptions=a||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return a.prototype.createTexture=function(b,c,a){void 0===a&&(a=d.G5.NONE);var e=new af(Object.assign({width:b,height:c,resolution:1,multisample:a},this.textureOptions));return new ai(e)},a.prototype.getOptimalTexture=function(a,b,f,c){void 0===f&&(f=1),void 0===c&&(c=d.G5.NONE),a=Math.ceil(a*f-1e-6),b=Math.ceil(b*f-1e-6),this.enableFullScreen&&a===this._pixelsWidth&&b===this._pixelsHeight?h=c>1?-c:-1:(a=(0,e.a9)(a),b=(0,e.a9)(b),h=((65535&a)<<16|65535&b)>>>0,c>1&&(h+=4294967296*c)),this.texturePool[h]||(this.texturePool[h]=[]);var h,g=this.texturePool[h].pop();return g||(g=this.createTexture(a,b,c)),g.filterPoolKey=h,g.setResolution(f),g},a.prototype.getFilterTexture=function(a,c,e){var b=this.getOptimalTexture(a.width,a.height,c||a.resolution,e||d.G5.NONE);return b.filterFrame=a.filterFrame,b},a.prototype.returnTexture=function(a){var b=a.filterPoolKey;a.filterFrame=null,this.texturePool[b].push(a)},a.prototype.returnFilterTexture=function(a){this.returnTexture(a)},a.prototype.clear=function(c){if(c=!1!==c)for(var d in this.texturePool){var a=this.texturePool[d];if(a)for(var b=0;b<a.length;b++)a[b].destroy(!0)}this.texturePool={}},a.prototype.setScreenSize=function(a){if(a.width!==this._pixelsWidth||a.height!==this._pixelsHeight){for(var b in this.enableFullScreen=a.width>0&&a.height>0,this.texturePool)if(0>Number(b)){var c=this.texturePool[b];if(c)for(var d=0;d<c.length;d++)c[d].destroy(!0);this.texturePool[b]=[]}this._pixelsWidth=a.width,this._pixelsHeight=a.height}},a.SCREEN_KEY=-1,a}(),ak=function(){function a(e,a,b,c,f,g,h){void 0===a&&(a=0),void 0===b&&(b=!1),void 0===c&&(c=d.vK.FLOAT),this.buffer=e,this.size=a,this.normalized=b,this.type=c,this.stride=f,this.start=g,this.instance=h}return a.prototype.destroy=function(){this.buffer=null},a.from=function(b,c,d,e,f){return new a(b,c,d,e,f)},a}(),al=0,am=function(){function a(c,a,b){void 0===a&&(a=!0),void 0===b&&(b=!1),this.data=c||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=b,this.static=a,this.id=al++,this.disposeRunner=new Z.R("disposeBuffer")}return a.prototype.update=function(a){a instanceof Array&&(a=new Float32Array(a)),this.data=a||this.data,this._updateID++},a.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},a.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(a.prototype,"index",{get:function(){return this.type===d.mr.ELEMENT_ARRAY_BUFFER},set:function(a){this.type=a?d.mr.ELEMENT_ARRAY_BUFFER:d.mr.ARRAY_BUFFER},enumerable:!1,configurable:!0}),a.from=function(b){return b instanceof Array&&(b=new Float32Array(b)),new a(b)},a}(),an={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array},ao={5126:4,5123:2,5121:1},ap=0,aq={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},i=function(){function a(a,b){void 0===a&&(a=[]),void 0===b&&(b={}),this.buffers=a,this.indexBuffer=null,this.attributes=b,this.glVertexArrayObjects={},this.id=ap++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Z.R("disposeGeometry"),this.refCount=0}return a.prototype.addAttribute=function(h,a,b,c,i,j,k,d){if(void 0===b&&(b=0),void 0===c&&(c=!1),void 0===d&&(d=!1),!a)throw Error("You must pass a buffer when creating an attribute");a instanceof am||(a instanceof Array&&(a=new Float32Array(a)),a=new am(a));var e=h.split("|");if(e.length>1){for(var f=0;f<e.length;f++)this.addAttribute(e[f],a,b,c,i);return this}var g=this.buffers.indexOf(a);return -1===g&&(this.buffers.push(a),g=this.buffers.length-1),this.attributes[h]=new ak(g,b,c,i,j,k,d),this.instanced=this.instanced||d,this},a.prototype.getAttribute=function(a){return this.attributes[a]},a.prototype.getBuffer=function(a){return this.buffers[this.getAttribute(a).buffer]},a.prototype.addIndex=function(a){return a instanceof am||(a instanceof Array&&(a=new Uint16Array(a)),a=new am(a)),a.type=d.mr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=a,-1===this.buffers.indexOf(a)&&this.buffers.push(a),this},a.prototype.getIndex=function(){return this.indexBuffer},a.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var a,c=[],d=[],f=new am;for(a in this.attributes){var b=this.attributes[a],g=this.buffers[b.buffer];c.push(g.data),d.push(b.size*ao[b.type]/4),b.buffer=0}for(a=0,f.data=function(c,i){for(var j=0,k=0,f={},a=0;a<c.length;a++)k+=i[a],j+=c[a].length;for(var l=new ArrayBuffer(4*j),m=null,n=0,a=0;a<c.length;a++){var g=i[a],h=c[a],d=(0,e.u7)(h);f[d]||(f[d]=new an[d](l)),m=f[d];for(var b=0;b<h.length;b++){var o=(b/g|0)*k+n,p=b%g;m[o+p]=h[b]}n+=g}return new Float32Array(l)}(c,d);a<this.buffers.length;a++)this.buffers[a]!==this.indexBuffer&&this.buffers[a].destroy();return this.buffers=[f],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},a.prototype.getSize=function(){for(var b in this.attributes){var a=this.attributes[b];return this.buffers[a.buffer].data.length/(a.stride/4||a.size)}return 0},a.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},a.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},a.prototype.clone=function(){for(var e=new a,b=0;b<this.buffers.length;b++)e.buffers[b]=new am(this.buffers[b].data.slice(0));for(var b in this.attributes){var c=this.attributes[b];e.attributes[b]=new ak(c.buffer,c.size,c.normalized,c.type,c.stride,c.start,c.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=d.mr.ELEMENT_ARRAY_BUFFER),e},a.merge=function(g){for(var f,h=new a,j=[],i=[],k=[],b=0;b<g.length;b++){f=g[b];for(var c=0;c<f.buffers.length;c++)i[c]=i[c]||0,i[c]+=f.buffers[c].data.length,k[c]=0}for(var b=0;b<f.buffers.length;b++)j[b]=new aq[(0,e.u7)(f.buffers[b].data)](i[b]),h.buffers[b]=new am(j[b]);for(var b=0;b<g.length;b++){f=g[b];for(var c=0;c<f.buffers.length;c++)j[c].set(f.buffers[c].data,k[c]),k[c]+=f.buffers[c].data.length}if(h.attributes=f.attributes,f.indexBuffer){h.indexBuffer=h.buffers[f.buffers.indexOf(f.indexBuffer)],h.indexBuffer.type=d.mr.ELEMENT_ARRAY_BUFFER;for(var n=0,o=0,p=0,l=0,b=0;b<f.buffers.length;b++)if(f.buffers[b]!==f.indexBuffer){l=b;break}for(var b in f.attributes){var m=f.attributes[b];(0|m.buffer)===l&&(o+=m.size*ao[m.type]/4)}for(var b=0;b<g.length;b++){for(var q=g[b].indexBuffer.data,c=0;c<q.length;c++)h.indexBuffer.data[c+p]+=n;n+=g[b].buffers[l].data.length/o,p+=q.length}}return h},a}(),ar=function(b){function a(){var a=b.call(this)||this;return a.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),a}return aa(a,b),a}(i),as=function(b){function a(){var a=b.call(this)||this;return a.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),a.uvs=new Float32Array([0,0,1,0,1,1,0,1]),a.vertexBuffer=new am(a.vertices),a.uvBuffer=new am(a.uvs),a.addAttribute("aVertexPosition",a.vertexBuffer).addAttribute("aTextureCoord",a.uvBuffer).addIndex([0,1,2,0,2,3]),a}return aa(a,b),a.prototype.map=function(d,a){var b=0,c=0;return this.uvs[0]=b,this.uvs[1]=c,this.uvs[2]=b+a.width/d.width,this.uvs[3]=c,this.uvs[4]=b+a.width/d.width,this.uvs[5]=c+a.height/d.height,this.uvs[6]=b,this.uvs[7]=c+a.height/d.height,b=a.x,c=a.y,this.vertices[0]=b,this.vertices[1]=c,this.vertices[2]=b+a.width,this.vertices[3]=c,this.vertices[4]=b+a.width,this.vertices[5]=c+a.height,this.vertices[6]=b,this.vertices[7]=c+a.height,this.invalidate(),this},a.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},a}(i),at=0,au=function(){function a(a,b,c){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=at++,this.static=!!b,this.ubo=!!c,a instanceof am?(this.buffer=a,this.buffer.type=d.mr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=a,this.ubo&&(this.buffer=new am(new Float32Array(1)),this.buffer.type=d.mr.UNIFORM_BUFFER,this.autoManage=!0))}return a.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},a.prototype.add=function(b,c,d){if(this.ubo)throw Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[b]=new a(c,d)},a.from=function(b,c,d){return new a(b,c,d)},a.uboFrom=function(c,b){return new a(c,null==b||b,!0)},a}(),av=function(){function b(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=d.G5.NONE,this.sourceFrame=new a.Ae,this.destinationFrame=new a.Ae,this.bindingSourceFrame=new a.Ae,this.bindingDestinationFrame=new a.Ae,this.filters=[],this.transform=null}return b.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},b}(),aw=[new a.E9,new a.E9,new a.E9,new a.E9],ax=new a.y3,A=function(){function b(b){this.renderer=b,this.defaultFilterStack=[{}],this.texturePool=new aj,this.texturePool.setScreenSize(b.view),this.statePool=[],this.quad=new ar,this.quadUv=new as,this.tempRect=new a.Ae,this.activeState={},this.globalUniforms=new au({outputFrame:new a.Ae,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return b.prototype.push=function(j,c){for(var k,l,d=this.renderer,q=this.defaultFilterStack,a=this.statePool.pop()||new av,b=this.renderer.renderTexture,g=c[0].resolution,h=c[0].multisample,i=c[0].padding,m=c[0].autoFit,n=null===(k=c[0].legacy)|| void 0===k||k,o=1;o<c.length;o++){var e=c[o];g=Math.min(g,e.resolution),h=Math.min(h,e.multisample),i=this.useMaxPadding?Math.max(i,e.padding):i+e.padding,m=m&&e.autoFit,n=n||null===(l=e.legacy)|| void 0===l||l}1===q.length&&(this.defaultFilterStack[0].renderTexture=b.current),q.push(a),a.resolution=g,a.multisample=h,a.legacy=n,a.target=j,a.sourceFrame.copyFrom(j.filterArea||j.getBounds(!0)),a.sourceFrame.pad(i);var p=this.tempRect.copyFrom(b.sourceFrame);d.projection.transform&&this.transformAABB(ax.copyFrom(d.projection.transform).invert(),p),m?(a.sourceFrame.fit(p),(a.sourceFrame.width<=0||a.sourceFrame.height<=0)&&(a.sourceFrame.width=0,a.sourceFrame.height=0)):a.sourceFrame.intersects(p)||(a.sourceFrame.width=0,a.sourceFrame.height=0),this.roundFrame(a.sourceFrame,b.current?b.current.resolution:d.resolution,b.sourceFrame,b.destinationFrame,d.projection.transform),a.renderTexture=this.getOptimalFilterTexture(a.sourceFrame.width,a.sourceFrame.height,g,h),a.filters=c,a.destinationFrame.width=a.renderTexture.width,a.destinationFrame.height=a.renderTexture.height;var f=this.tempRect;f.x=0,f.y=0,f.width=a.sourceFrame.width,f.height=a.sourceFrame.height,a.renderTexture.filterFrame=a.sourceFrame,a.bindingSourceFrame.copyFrom(b.sourceFrame),a.bindingDestinationFrame.copyFrom(b.destinationFrame),a.transform=d.projection.transform,d.projection.transform=null,b.bind(a.renderTexture,a.sourceFrame,f),d.framebuffer.clear(0,0,0,0)},b.prototype.pop=function(){var l=this.defaultFilterStack,a=l.pop(),i=a.filters;this.activeState=a;var f=this.globalUniforms.uniforms;f.outputFrame=a.sourceFrame,f.resolution=a.resolution;var c=f.inputSize,e=f.inputPixel,j=f.inputClamp;if(c[0]=a.destinationFrame.width,c[1]=a.destinationFrame.height,c[2]=1/c[0],c[3]=1/c[1],e[0]=Math.round(c[0]*a.resolution),e[1]=Math.round(c[1]*a.resolution),e[2]=1/e[0],e[3]=1/e[1],j[0]=.5*e[2],j[1]=.5*e[3],j[2]=a.sourceFrame.width*c[2]-.5*e[2],j[3]=a.sourceFrame.height*c[3]-.5*e[3],a.legacy){var k=f.filterArea;k[0]=a.destinationFrame.width,k[1]=a.destinationFrame.height,k[2]=a.sourceFrame.x,k[3]=a.sourceFrame.y,f.filterClamp=f.inputClamp}this.globalUniforms.update();var m=l[l.length-1];if(this.renderer.framebuffer.blit(),1===i.length)i[0].apply(this,a.renderTexture,m.renderTexture,d.yl.BLEND,a),this.returnFilterTexture(a.renderTexture);else{var b=a.renderTexture,h=this.getOptimalFilterTexture(b.width,b.height,a.resolution);h.filterFrame=b.filterFrame;var g=0;for(g=0;g<i.length-1;++g){1===g&&a.multisample>1&&((h=this.getOptimalFilterTexture(b.width,b.height,a.resolution)).filterFrame=b.filterFrame),i[g].apply(this,b,h,d.yl.CLEAR,a);var n=b;b=h,h=n}i[g].apply(this,b,m.renderTexture,d.yl.BLEND,a),g>1&&a.multisample>1&&this.returnFilterTexture(a.renderTexture),this.returnFilterTexture(b),this.returnFilterTexture(h)}a.clear(),this.statePool.push(a)},b.prototype.bindAndClear=function(a,c){void 0===c&&(c=d.yl.CLEAR);var e=this.renderer,f=e.renderTexture,g=e.state;if(a===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,a&&a.filterFrame){var b=this.tempRect;b.x=0,b.y=0,b.width=a.filterFrame.width,b.height=a.filterFrame.height,f.bind(a,a.filterFrame,b)}else a!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?f.bind(a):this.renderer.renderTexture.bind(a,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var h=1&g.stateId||this.forceClear;(c===d.yl.CLEAR||c===d.yl.BLIT&&h)&&this.renderer.framebuffer.clear(0,0,0,0)},b.prototype.applyFilter=function(a,c,e,f){var b=this.renderer;b.state.set(a.state),this.bindAndClear(e,f),a.uniforms.uSampler=c,a.uniforms.filterGlobals=this.globalUniforms,b.shader.bind(a),a.legacy=!!a.program.attributeData.aTextureCoord,a.legacy?(this.quadUv.map(c._frame,c.filterFrame),b.geometry.bind(this.quadUv),b.geometry.draw(d.lg.TRIANGLES)):(b.geometry.bind(this.quad),b.geometry.draw(d.lg.TRIANGLE_STRIP))},b.prototype.calculateSpriteMatrix=function(i,b){var d=this.activeState,e=d.sourceFrame,f=d.destinationFrame,g=b._texture.orig,c=i.set(f.width,0,0,f.height,e.x,e.y),h=b.worldTransform.copyTo(a.y3.TEMP_MATRIX);return h.invert(),c.prepend(h),c.scale(1/g.width,1/g.height),c.translate(b.anchor.x,b.anchor.y),c},b.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},b.prototype.getOptimalFilterTexture=function(c,e,a,b){return void 0===a&&(a=1),void 0===b&&(b=d.G5.NONE),this.texturePool.getOptimalTexture(c,e,a,b)},b.prototype.getFilterTexture=function(a,b,e){if("number"==typeof a){var f=a;a=b,b=f}a=a||this.activeState.renderTexture;var c=this.texturePool.getOptimalTexture(a.width,a.height,b||a.resolution,e||d.G5.NONE);return c.filterFrame=a.filterFrame,c},b.prototype.returnFilterTexture=function(a){this.texturePool.returnTexture(a)},b.prototype.emptyPool=function(){this.texturePool.clear(!0)},b.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},b.prototype.transformAABB=function(f,a){var b=aw[0],c=aw[1],d=aw[2],e=aw[3];b.set(a.left,a.top),c.set(a.left,a.bottom),d.set(a.right,a.top),e.set(a.right,a.bottom),f.apply(b,b),f.apply(c,c),f.apply(d,d),f.apply(e,e);var g=Math.min(b.x,c.x,d.x,e.x),h=Math.min(b.y,c.y,d.y,e.y),i=Math.max(b.x,c.x,d.x,e.x),j=Math.max(b.y,c.y,d.y,e.y);a.x=g,a.y=h,a.width=i-g,a.height=j-h},b.prototype.roundFrame=function(c,e,b,d,a){if(!(c.width<=0)&&!(c.height<=0)&&!(b.width<=0)&&!(b.height<=0)){if(a){var f=a.a,g=a.b,h=a.c,i=a.d;if((Math.abs(g)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(f)>1e-4||Math.abs(i)>1e-4))return}(a=a?ax.copyFrom(a):ax.identity()).translate(-b.x,-b.y).scale(d.width/b.width,d.height/b.height).translate(d.x,d.y),this.transformAABB(a,c),c.ceil(e),this.transformAABB(a.invert(),c)}},b}(),B=function(){function a(a){this.renderer=a}return a.prototype.flush=function(){},a.prototype.destroy=function(){this.renderer=null},a.prototype.start=function(){},a.prototype.stop=function(){this.flush()},a.prototype.render=function(a){},a}(),C=function(){function a(a){this.renderer=a,this.emptyRenderer=new B(a),this.currentRenderer=this.emptyRenderer}return a.prototype.setObjectRenderer=function(a){this.currentRenderer!==a&&(this.currentRenderer.stop(),this.currentRenderer=a,this.currentRenderer.start())},a.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},a.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},a.prototype.copyBoundTextures=function(b,c){for(var d=this.renderer.texture.boundTextures,a=c-1;a>=0;--a)b[a]=d[a]||null,b[a]&&(b[a]._batchLocation=a)},a.prototype.boundArray=function(e,f,j,h){for(var k=e.elements,i=e.ids,l=e.count,a=0,b=0;b<l;b++){var c=k[b],d=c._batchLocation;if(d>=0&&d<h&&f[d]===c){i[b]=d;continue}for(;a<h;){var g=f[a];if(g&&g._batchEnabled===j&&g._batchLocation===a){a++;continue}i[b]=a,c._batchLocation=a,f[a]=c;break}}},a.prototype.destroy=function(){this.renderer=null},a}(),ay=0,D=function(){function a(a){this.renderer=a,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),a.view.addEventListener("webglcontextlost",this.handleContextLost,!1),a.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(a.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),a.prototype.contextChange=function(a){this.gl=a,this.renderer.gl=a,this.renderer.CONTEXT_UID=ay++,a.isContextLost()&&a.getExtension("WEBGL_lose_context")&&a.getExtension("WEBGL_lose_context").restoreContext()},a.prototype.initFromContext=function(a){this.gl=a,this.validateContext(a),this.renderer.gl=a,this.renderer.CONTEXT_UID=ay++,this.renderer.runners.contextChange.emit(a)},a.prototype.initFromOptions=function(a){var b=this.createContext(this.renderer.view,a);this.initFromContext(b)},a.prototype.createContext=function(b,c){var a;if(k.X.PREFER_ENV>=d.Vi.WEBGL2&&(a=b.getContext("webgl2",c)),a)this.webGLVersion=2;else if(this.webGLVersion=1,!(a=b.getContext("webgl",c)||b.getContext("experimental-webgl",c)))throw Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=a,this.getExtensions(),this.gl},a.prototype.getExtensions=function(){var a=this.gl,b={anisotropicFiltering:a.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:a.getExtension("OES_texture_float_linear"),s3tc:a.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:a.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:a.getExtension("WEBGL_compressed_texture_etc"),etc1:a.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:a.getExtension("WEBGL_compressed_texture_atc"),astc:a.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,b,{drawBuffers:a.getExtension("WEBGL_draw_buffers"),depthTexture:a.getExtension("WEBGL_depth_texture"),loseContext:a.getExtension("WEBGL_lose_context"),vertexArrayObject:a.getExtension("OES_vertex_array_object")||a.getExtension("MOZ_OES_vertex_array_object")||a.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:a.getExtension("OES_element_index_uint"),floatTexture:a.getExtension("OES_texture_float"),floatTextureLinear:a.getExtension("OES_texture_float_linear"),textureHalfFloat:a.getExtension("OES_texture_half_float"),textureHalfFloatLinear:a.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,b,{colorBufferFloat:a.getExtension("EXT_color_buffer_float")})},a.prototype.handleContextLost=function(a){a.preventDefault()},a.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},a.prototype.destroy=function(){var a=this.renderer.view;this.renderer=null,a.removeEventListener("webglcontextlost",this.handleContextLost),a.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},a.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},a.prototype.validateContext=function(a){var b=a.getContextAttributes(),c="WebGL2RenderingContext"in globalThis&&a instanceof globalThis.WebGL2RenderingContext;c&&(this.webGLVersion=2),b&&!b.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var d=c||!!a.getExtension("OES_element_index_uint");this.supports.uint32Indices=d,d||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},a}(),az=function(a){this.framebuffer=a,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=d.G5.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},aA=new a.Ae,E=function(){function b(a){this.renderer=a,this.managedFramebuffers=[],this.unknownFramebuffer=new ae(10,10),this.msaaSamples=null}return b.prototype.contextChange=function(){var b=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new a.Ae,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var c=this.renderer.context.extensions.drawBuffers,e=this.renderer.context.extensions.depthTexture;k.X.PREFER_ENV===d.Vi.WEBGL_LEGACY&&(c=null,e=null),c?b.drawBuffers=function(a){return c.drawBuffersWEBGL(a)}:(this.hasMRT=!1,b.drawBuffers=function(){}),e||(this.writeDepthTexture=!1)}else this.msaaSamples=b.getInternalformatParameter(b.RENDERBUFFER,b.RGBA8,b.SAMPLES)},b.prototype.bind=function(a,b,d){void 0===d&&(d=0);var e=this.gl;if(a){var c=a.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(a);this.current!==a&&(this.current=a,e.bindFramebuffer(e.FRAMEBUFFER,c.framebuffer)),c.mipLevel!==d&&(a.dirtyId++,a.dirtyFormat++,c.mipLevel=d),c.dirtyId!==a.dirtyId&&(c.dirtyId=a.dirtyId,c.dirtyFormat!==a.dirtyFormat?(c.dirtyFormat=a.dirtyFormat,c.dirtySize=a.dirtySize,this.updateFramebuffer(a,d)):c.dirtySize!==a.dirtySize&&(c.dirtySize=a.dirtySize,this.resizeFramebuffer(a)));for(var g=0;g<a.colorTextures.length;g++){var i=a.colorTextures[g];this.renderer.texture.unbind(i.parentTextureArray||i)}if(a.depthTexture&&this.renderer.texture.unbind(a.depthTexture),b){var f=b.width>>d,h=b.height>>d,j=f/b.width;this.setViewport(b.x*j,b.y*j,f,h)}else{var f=a.width>>d,h=a.height>>d;this.setViewport(0,0,f,h)}}else this.current&&(this.current=null,e.bindFramebuffer(e.FRAMEBUFFER,null)),b?this.setViewport(b.x,b.y,b.width,b.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},b.prototype.setViewport=function(b,c,d,e){var a=this.viewport;b=Math.round(b),c=Math.round(c),d=Math.round(d),e=Math.round(e),(a.width!==d||a.height!==e||a.x!==b||a.y!==c)&&(a.x=b,a.y=c,a.width=d,a.height=e,this.gl.viewport(b,c,d,e))},Object.defineProperty(b.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),b.prototype.clear=function(c,e,f,g,a){void 0===a&&(a=d.V0.COLOR|d.V0.DEPTH);var b=this.gl;b.clearColor(c,e,f,g),b.clear(a)},b.prototype.initFramebuffer=function(a){var c=this.gl,b=new az(c.createFramebuffer());return b.multisample=this.detectSamples(a.multisample),a.glFramebuffers[this.CONTEXT_UID]=b,this.managedFramebuffers.push(a),a.disposeRunner.add(this),b},b.prototype.resizeFramebuffer=function(b){var a=this.gl,c=b.glFramebuffers[this.CONTEXT_UID];c.msaaBuffer&&(a.bindRenderbuffer(a.RENDERBUFFER,c.msaaBuffer),a.renderbufferStorageMultisample(a.RENDERBUFFER,c.multisample,a.RGBA8,b.width,b.height)),c.stencil&&(a.bindRenderbuffer(a.RENDERBUFFER,c.stencil),c.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,c.multisample,a.DEPTH24_STENCIL8,b.width,b.height):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,b.width,b.height));var f=b.colorTextures,d=f.length;a.drawBuffers||(d=Math.min(d,1));for(var e=0;e<d;e++){var g=f[e],h=g.parentTextureArray||g;this.renderer.texture.bind(h,0)}b.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(b.depthTexture,0)},b.prototype.updateFramebuffer=function(c,h){var a=this.gl,b=c.glFramebuffers[this.CONTEXT_UID],i=c.colorTextures,e=i.length;a.drawBuffers||(e=Math.min(e,1)),b.multisample>1&&this.canMultisampleFramebuffer(c)?(b.msaaBuffer=b.msaaBuffer||a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,b.msaaBuffer),a.renderbufferStorageMultisample(a.RENDERBUFFER,b.multisample,a.RGBA8,c.width,c.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,b.msaaBuffer)):b.msaaBuffer&&(a.deleteRenderbuffer(b.msaaBuffer),b.msaaBuffer=null,b.blitFramebuffer&&(b.blitFramebuffer.dispose(),b.blitFramebuffer=null));for(var f=[],d=0;d<e;d++){var g=i[d],j=g.parentTextureArray||g;this.renderer.texture.bind(j,0),(0!==d||!b.msaaBuffer)&&(a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+d,g.target,j._glTextures[this.CONTEXT_UID].texture,h),f.push(a.COLOR_ATTACHMENT0+d))}if(f.length>1&&a.drawBuffers(f),c.depthTexture&&this.writeDepthTexture){var k=c.depthTexture;this.renderer.texture.bind(k,0),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,k._glTextures[this.CONTEXT_UID].texture,h)}(c.stencil||c.depth)&&!(c.depthTexture&&this.writeDepthTexture)?(b.stencil=b.stencil||a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,b.stencil),b.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,b.multisample,a.DEPTH24_STENCIL8,c.width,c.height):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,c.width,c.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,b.stencil)):b.stencil&&(a.deleteRenderbuffer(b.stencil),b.stencil=null)},b.prototype.canMultisampleFramebuffer=function(a){return 1!==this.renderer.context.webGLVersion&&a.colorTextures.length<=1&&!a.depthTexture},b.prototype.detectSamples=function(e){var b=this.msaaSamples,a=d.G5.NONE;if(e<=1||null===b)return a;for(var c=0;c<b.length;c++)if(b[c]<=e){a=b[c];break}return 1===a&&(a=d.G5.NONE),a},b.prototype.blit=function(a,c,d){var b=this.current,h=this.renderer,f=this.gl,i=this.CONTEXT_UID;if(2===h.context.webGLVersion&&b){var e=b.glFramebuffers[i];if(e){if(!a){if(!e.msaaBuffer)return;var g=b.colorTextures[0];if(!g)return;e.blitFramebuffer||(e.blitFramebuffer=new ae(b.width,b.height),e.blitFramebuffer.addColorTexture(0,g)),(a=e.blitFramebuffer).colorTextures[0]!==g&&(a.colorTextures[0]=g,a.dirtyId++,a.dirtyFormat++),(a.width!==b.width||a.height!==b.height)&&(a.width=b.width,a.height=b.height,a.dirtyId++,a.dirtySize++)}c||((c=aA).width=b.width,c.height=b.height),d||(d=c);var j=c.width===d.width&&c.height===d.height;this.bind(a),f.bindFramebuffer(f.READ_FRAMEBUFFER,e.framebuffer),f.blitFramebuffer(c.left,c.top,c.right,c.bottom,d.left,d.top,d.right,d.bottom,f.COLOR_BUFFER_BIT,j?f.NEAREST:f.LINEAR)}}},b.prototype.disposeFramebuffer=function(b,e){var a=b.glFramebuffers[this.CONTEXT_UID],c=this.gl;if(a){delete b.glFramebuffers[this.CONTEXT_UID];var d=this.managedFramebuffers.indexOf(b);d>=0&&this.managedFramebuffers.splice(d,1),b.disposeRunner.remove(this),!e&&(c.deleteFramebuffer(a.framebuffer),a.msaaBuffer&&c.deleteRenderbuffer(a.msaaBuffer),a.stencil&&c.deleteRenderbuffer(a.stencil)),a.blitFramebuffer&&a.blitFramebuffer.dispose()}},b.prototype.disposeAll=function(c){var b=this.managedFramebuffers;this.managedFramebuffers=[];for(var a=0;a<b.length;a++)this.disposeFramebuffer(b[a],c)},b.prototype.forceStencil=function(){var b=this.current;if(b){var c=b.glFramebuffers[this.CONTEXT_UID];if(c&&!c.stencil){b.stencil=!0;var e=b.width,f=b.height,a=this.gl,d=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,d),c.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,c.multisample,a.DEPTH24_STENCIL8,e,f):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,e,f),c.stencil=d,a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,d)}}},b.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new a.Ae},b.prototype.destroy=function(){this.renderer=null},b}(),aB={5126:4,5123:2,5121:1},F=function(){function a(a){this.renderer=a,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return a.prototype.contextChange=function(){this.disposeAll(!0);var a=this.gl=this.renderer.gl,b=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==b.webGLVersion){var c=this.renderer.context.extensions.vertexArrayObject;k.X.PREFER_ENV===d.Vi.WEBGL_LEGACY&&(c=null),c?(a.createVertexArray=function(){return c.createVertexArrayOES()},a.bindVertexArray=function(a){return c.bindVertexArrayOES(a)},a.deleteVertexArray=function(a){return c.deleteVertexArrayOES(a)}):(this.hasVao=!1,a.createVertexArray=function(){return null},a.bindVertexArray=function(){return null},a.deleteVertexArray=function(){return null})}if(2!==b.webGLVersion){var e=a.getExtension("ANGLE_instanced_arrays");e?(a.vertexAttribDivisor=function(a,b){return e.vertexAttribDivisorANGLE(a,b)},a.drawElementsInstanced=function(a,b,c,d,f){return e.drawElementsInstancedANGLE(a,b,c,d,f)},a.drawArraysInstanced=function(a,b,c,d){return e.drawArraysInstancedANGLE(a,b,c,d)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===b.webGLVersion||!!b.extensions.uint32ElementIndex},a.prototype.bind=function(a,b){b=b||this.renderer.shader.shader;var f=this.gl,c=a.glVertexArrayObjects[this.CONTEXT_UID],e=!1;c||(this.managedGeometries[a.id]=a,a.disposeRunner.add(this),a.glVertexArrayObjects[this.CONTEXT_UID]=c={},e=!0);var d=c[b.program.id]||this.initGeometryVao(a,b,e);this._activeGeometry=a,this._activeVao!==d&&(this._activeVao=d,this.hasVao?f.bindVertexArray(d):this.activateVao(a,b.program)),this.updateBuffers()},a.prototype.reset=function(){this.unbind()},a.prototype.updateBuffers=function(){for(var b=this._activeGeometry,c=this.renderer.buffer,a=0;a<b.buffers.length;a++){var d=b.buffers[a];c.update(d)}},a.prototype.checkCompatibility=function(b,c){var d=b.attributes,e=c.attributeData;for(var a in e)if(!d[a])throw Error('shader and geometry incompatible, geometry missing the "'+a+'" attribute')},a.prototype.getSignature=function(b,e){var f=b.attributes,c=e.attributeData,d=["g",b.id];for(var a in f)c[a]&&d.push(a,c[a].location);return d.join("-")},a.prototype.initGeometryVao=function(f,m,i){void 0===i&&(i=!0);var n=this.gl,o=this.CONTEXT_UID,s=this.renderer.buffer,e=m.program;e.glPrograms[o]||this.renderer.shader.generateProgram(m),this.checkCompatibility(f,e);var p=this.getSignature(f,e),g=f.glVertexArrayObjects[this.CONTEXT_UID],c=g[p];if(c)return g[e.id]=c,c;var j=f.buffers,d=f.attributes,h={},k={};for(var a in j)h[a]=0,k[a]=0;for(var a in d)!d[a].size&&e.attributeData[a]?d[a].size=e.attributeData[a].size:d[a].size||console.warn("PIXI Geometry attribute '"+a+"' size cannot be determined (likely the bound shader does not have the attribute)"),h[d[a].buffer]+=d[a].size*aB[d[a].type];for(var a in d){var b=d[a],q=b.size;void 0===b.stride&&(h[b.buffer]===q*aB[b.type]?b.stride=0:b.stride=h[b.buffer]),void 0===b.start&&(b.start=k[b.buffer],k[b.buffer]+=q*aB[b.type])}c=n.createVertexArray(),n.bindVertexArray(c);for(var l=0;l<j.length;l++){var r=j[l];s.bind(r),i&&r._glBuffers[o].refCount++}return this.activateVao(f,e),this._activeVao=c,g[e.id]=c,g[p]=c,c},a.prototype.disposeGeometry=function(a,c){if(this.managedGeometries[a.id]){delete this.managedGeometries[a.id];var d,e=a.glVertexArrayObjects[this.CONTEXT_UID],k=this.gl,f=a.buffers,h=null===(d=this.renderer)|| void 0===d?void 0:d.buffer;if(a.disposeRunner.remove(this),e){if(h)for(var b=0;b<f.length;b++){var g=f[b]._glBuffers[this.CONTEXT_UID];g&&(g.refCount--,0!==g.refCount||c||h.dispose(f[b],c))}if(!c){for(var i in e)if("g"===i[0]){var j=e[i];this._activeVao===j&&this.unbind(),k.deleteVertexArray(j)}}delete a.glVertexArrayObjects[this.CONTEXT_UID]}}},a.prototype.disposeAll=function(c){for(var b=Object.keys(this.managedGeometries),a=0;a<b.length;a++)this.disposeGeometry(this.managedGeometries[b[a]],c)},a.prototype.activateVao=function(b,f){var c=this.gl,l=this.CONTEXT_UID,g=this.renderer.buffer,m=b.buffers,h=b.attributes;b.indexBuffer&&g.bind(b.indexBuffer);var i=null;for(var d in h){var a=h[d],j=m[a.buffer],k=j._glBuffers[l];if(f.attributeData[d]){i!==k&&(g.bind(j),i=k);var e=f.attributeData[d].location;if(c.enableVertexAttribArray(e),c.vertexAttribPointer(e,a.size,a.type||c.FLOAT,a.normalized,a.stride,a.start),a.instance){if(this.hasInstance)c.vertexAttribDivisor(e,1);else throw Error("geometry error, GPU Instancing is not supported on this device")}}}},a.prototype.draw=function(d,e,f,g){var b=this.gl,a=this._activeGeometry;if(a.indexBuffer){var c=a.indexBuffer.data.BYTES_PER_ELEMENT,h=2===c?b.UNSIGNED_SHORT:b.UNSIGNED_INT;2===c||4===c&&this.canUseUInt32ElementIndex?a.instanced?b.drawElementsInstanced(d,e||a.indexBuffer.data.length,h,(f||0)*c,g||1):b.drawElements(d,e||a.indexBuffer.data.length,h,(f||0)*c):console.warn("unsupported index buffer type: uint32")}else a.instanced?b.drawArraysInstanced(d,f,e||a.getSize(),g||1):b.drawArrays(d,f,e||a.getSize());return this},a.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},a.prototype.destroy=function(){this.renderer=null},a}(),aC=function(){function a(a){void 0===a&&(a=null),this.type=d.A7.NONE,this.autoDetect=!0,this.maskObject=a||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=k.X.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(a.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(a){a?this._filters?this._filters[0]=a:this._filters=[a]:this._filters=null},enumerable:!1,configurable:!0}),a.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=d.A7.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},a.prototype.copyCountersOrReset=function(a){a?(this._stencilCounter=a._stencilCounter,this._scissorCounter=a._scissorCounter,this._scissorRect=a._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},a}();function aD(a,c,d){var b=a.createShader(c);return a.shaderSource(b,d),a.compileShader(b),b}function aE(a,b){var e=a.getShaderSource(b).split("\n").map(function(a,b){return b+": "+a}),c=a.getShaderInfoLog(b),f=c.split("\n"),i={},g=f.map(function(a){return parseFloat(a.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(a){return!!a&&!i[a]&&(i[a]=!0,!0)}),d=[""];g.forEach(function(a){e[a-1]="%c"+e[a-1]+"%c",d.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var h=e.join("\n");d[0]=h,console.error(c),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,d),console.groupEnd()}function aF(c){for(var a=Array(c),b=0;b<a.length;b++)a[b]=!1;return a}function aG(b,a){switch(b){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*a);case"vec3":return new Float32Array(3*a);case"vec4":return new Float32Array(4*a);case"ivec2":return new Int32Array(2*a);case"ivec3":return new Int32Array(3*a);case"ivec4":return new Int32Array(4*a);case"uvec2":return new Uint32Array(2*a);case"uvec3":return new Uint32Array(3*a);case"uvec4":return new Uint32Array(4*a);case"bool":return!1;case"bvec2":return aF(2*a);case"bvec3":return aF(3*a);case"bvec4":return aF(4*a);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var G={},aH=G;function aI(a,b,c){if("precision"!==a.substring(0,9)){var e=b;return b===d.cB.HIGH&&c!==d.cB.HIGH&&(e=d.cB.MEDIUM),"precision "+e+" float;\n"+a}return c!==d.cB.HIGH&&"precision highp"===a.substring(0,15)?a.replace("precision highp","precision mediump"):a}var aJ={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function aK(a){return aJ[a]}var aL=null,aM={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function aN(d,e){if(!aL){var b=Object.keys(aM);aL={};for(var a=0;a<b.length;++a){var c=b[a];aL[d[c]]=aM[c]}}return aL[e]}var aO=[{test:function(a){return"float"===a.type&&1===a.size},code:function(a){return'\n            if(uv["'+a+'"] !== ud["'+a+'"].value)\n            {\n                ud["'+a+'"].value = uv["'+a+'"]\n                gl.uniform1f(ud["'+a+'"].location, uv["'+a+'"])\n            }\n            '}},{test:function(a){return("sampler2D"===a.type||"samplerCube"===a.type||"sampler2DArray"===a.type)&&1===a.size&&!a.isArray},code:function(a){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+a+'"], t);\n\n            if(ud["'+a+'"].value !== t)\n            {\n                ud["'+a+'"].value = t;\n                gl.uniform1i(ud["'+a+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(a,b){return"mat3"===a.type&&1===a.size&& void 0!==b.a},code:function(a){return'\n            gl.uniformMatrix3fv(ud["'+a+'"].location, false, uv["'+a+'"].toArray(true));\n            '},codeUbo:function(a){return"\n                var "+a+"_matrix = uv."+a+".toArray(true);\n\n                data[offset] = "+a+"_matrix[0];\n                data[offset+1] = "+a+"_matrix[1];\n                data[offset+2] = "+a+"_matrix[2];\n        \n                data[offset + 4] = "+a+"_matrix[3];\n                data[offset + 5] = "+a+"_matrix[4];\n                data[offset + 6] = "+a+"_matrix[5];\n        \n                data[offset + 8] = "+a+"_matrix[6];\n                data[offset + 9] = "+a+"_matrix[7];\n                data[offset + 10] = "+a+"_matrix[8];\n            "}},{test:function(a,b){return"vec2"===a.type&&1===a.size&& void 0!==b.x},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+a+'"].location, v.x, v.y);\n                }'},codeUbo:function(a){return"\n                v = uv."+a+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(a){return"vec2"===a.type&&1===a.size},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+a+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(a,b){return"vec4"===a.type&&1===a.size&& void 0!==b.width},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+a+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(a){return"\n                    v = uv."+a+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(a){return"vec4"===a.type&&1===a.size},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+a+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],aP={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},aQ={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function aR(c){for(var b="",a=0;a<c;++a)a>0&&(b+="\nelse "),a<c-1&&(b+="if(test == "+a+".0){}");return b}var aS=0,aT={},aU=function(){function a(c,e,b){void 0===b&&(b="pixi-shader"),this.id=aS++,this.vertexSrc=c||a.defaultVertexSrc,this.fragmentSrc=e||a.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(aT[b=b.replace(/\s+/g,"-")]?(aT[b]++,b+="-"+aT[b]):aT[b]=1,this.vertexSrc="#define SHADER_NAME "+b+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+b+"\n"+this.fragmentSrc,this.vertexSrc=aI(this.vertexSrc,k.X.PRECISION_VERTEX,d.cB.HIGH),this.fragmentSrc=aI(this.fragmentSrc,k.X.PRECISION_FRAGMENT,function(){if(!X){X=d.cB.MEDIUM;var a=function(){if(aH===G||aH&&aH.isContextLost()){var b=document.createElement("canvas"),a=void 0;k.X.PREFER_ENV>=d.Vi.WEBGL2&&(a=b.getContext("webgl2",{})),a||((a=b.getContext("webgl",{})||b.getContext("experimental-webgl",{}))?a.getExtension("WEBGL_draw_buffers"):a=null),aH=a}return aH}();a&&a.getShaderPrecisionFormat&&(X=a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision?d.cB.HIGH:d.cB.MEDIUM)}return X}())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(a,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),a.from=function(c,d,g){var f=c+d,b=e.GG[f];return b||(e.GG[f]=b=new a(c,d,g)),b},a}(),H=function(){function a(b,a){this.uniformBindCount=0,this.program=b,a?a instanceof au?this.uniformGroup=a:this.uniformGroup=new au(a):this.uniformGroup=new au({})}return a.prototype.checkUniformExists=function(b,a){if(a.uniforms[b])return!0;for(var d in a.uniforms){var c=a.uniforms[d];if(c.group&&this.checkUniformExists(b,c))return!0}return!1},a.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(a.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),a.from=function(b,c,d){var e=aU.from(b,c);return new a(e,d)},a}(),aV=function(){function a(){this.data=0,this.blendMode=d.T$.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(a.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(a){!!(1&this.data)!==a&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(a){!!(2&this.data)!==a&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(a){!!(4&this.data)!==a&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(a){!!(8&this.data)!==a&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(a){!!(32&this.data)!==a&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(a){!!(16&this.data)!==a&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"blendMode",{get:function(){return this._blendMode},set:function(a){this.blend=a!==d.T$.NONE,this._blendMode=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(a){this.offsets=!!a,this._polygonOffset=a},enumerable:!1,configurable:!0}),a.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},a.for2d=function(){var b=new a;return b.depthTest=!1,b.blend=!0,b},a}(),I=function(b){function a(d,e,f){var c=this,g=aU.from(d||a.defaultVertexSrc,e||a.defaultFragmentSrc);return(c=b.call(this,g,f)||this).padding=0,c.resolution=k.X.FILTER_RESOLUTION,c.multisample=k.X.FILTER_MULTISAMPLE,c.enabled=!0,c.autoFit=!0,c.state=new aV,c}return aa(a,b),a.prototype.apply=function(a,b,c,d,e){a.applyFilter(this,b,c,d)},Object.defineProperty(a.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(a){this.state.blendMode=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"resolution",{get:function(){return this._resolution},set:function(a){this._resolution=a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),a}(H),aW=new a.y3,aX=function(){function b(c,b){this._texture=c,this.mapCoord=new a.y3,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===b?.5:b,this.isSimple=!1}return Object.defineProperty(b.prototype,"texture",{get:function(){return this._texture},set:function(a){this._texture=a,this._textureID=-1},enumerable:!1,configurable:!0}),b.prototype.multiplyUvs=function(d,c){void 0===c&&(c=d);for(var a=this.mapCoord,b=0;b<d.length;b+=2){var e=d[b],f=d[b+1];c[b]=e*a.a+f*a.c+a.tx,c[b+1]=e*a.b+f*a.d+a.ty}return c},b.prototype.update=function(i){var a=this._texture;if(!a||!a.valid|| !i&&this._textureID===a._updateID)return!1;this._textureID=a._updateID,this._updateID++;var b=a._uvs;this.mapCoord.set(b.x1-b.x0,b.y1-b.y0,b.x3-b.x0,b.y3-b.y0,b.x0,b.y0);var h=a.orig,d=a.trim;d&&(aW.set(h.width/d.width,0,0,h.height/d.height,-d.x/d.width,-d.y/d.height),this.mapCoord.append(aW));var c=a.baseTexture,f=this.uClampFrame,g=this.clampMargin/c.resolution,e=this.clampOffset;return f[0]=(a._frame.x+g+e)/c.width,f[1]=(a._frame.y+g+e)/c.height,f[2]=(a._frame.x+a._frame.width-g+e)/c.width,f[3]=(a._frame.y+a._frame.height-g+e)/c.height,this.uClampOffset[0]=e/c.realWidth,this.uClampOffset[1]=e/c.realHeight,this.isSimple=a._frame.width===c.width&&a._frame.height===c.height&&0===a.rotate,!0},b}(),aY=function(c){function b(b,d,e){var f=this,g=null;return"string"!=typeof b&& void 0===d&& void 0===e&&(g=b,b=void 0,d=void 0,e=void 0),(f=c.call(this,b||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",d||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",e)||this).maskSprite=g,f.maskMatrix=new a.y3,f}return aa(b,c),Object.defineProperty(b.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(a){this._maskSprite=a,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),b.prototype.apply=function(c,d,e,f){var b=this._maskSprite,a=b._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new aX(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=c.calculateSpriteMatrix(this.maskMatrix,b).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=b.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,c.applyFilter(this,d,e,f))},b}(I),J=function(){function a(a){this.renderer=a,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return a.prototype.setMaskStack=function(a){this.maskStack=a,this.renderer.scissor.setMaskStack(a),this.renderer.stencil.setMaskStack(a)},a.prototype.push=function(e,c){var a=c;if(!a.isMaskData){var b=this.maskDataPool.pop()||new aC;b.pooled=!0,b.maskObject=c,a=b}var f=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(a.copyCountersOrReset(f),a.autoDetect&&this.detect(a),a._target=e,a.type!==d.A7.SPRITE&&this.maskStack.push(a),a.enabled)switch(a.type){case d.A7.SCISSOR:this.renderer.scissor.push(a);break;case d.A7.STENCIL:this.renderer.stencil.push(a);break;case d.A7.SPRITE:a.copyCountersOrReset(null),this.pushSpriteMask(a)}a.type===d.A7.SPRITE&&this.maskStack.push(a)},a.prototype.pop=function(c){var a=this.maskStack.pop();if(a&&a._target===c){if(a.enabled)switch(a.type){case d.A7.SCISSOR:this.renderer.scissor.pop();break;case d.A7.STENCIL:this.renderer.stencil.pop(a.maskObject);break;case d.A7.SPRITE:this.popSpriteMask(a)}if(a.reset(),a.pooled&&this.maskDataPool.push(a),0!==this.maskStack.length){var b=this.maskStack[this.maskStack.length-1];b.type===d.A7.SPRITE&&b._filters&&(b._filters[0].maskSprite=b.maskObject)}}},a.prototype.detect=function(a){a.maskObject.isSprite?a.type=d.A7.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(a)?a.type=d.A7.SCISSOR:a.type=d.A7.STENCIL},a.prototype.pushSpriteMask=function(a){var e,f,g,h,i=a.maskObject,c=a._target,b=a._filters;b||(b=this.alphaMaskPool[this.alphaMaskIndex])||(b=this.alphaMaskPool[this.alphaMaskIndex]=[new aY]);var d=this.renderer,j=d.renderTexture;if(j.current){var k=j.current;g=a.resolution||k.resolution,h=null!==(e=a.multisample)&& void 0!==e?e:k.multisample}else g=a.resolution||d.resolution,h=null!==(f=a.multisample)&& void 0!==f?f:d.multisample;b[0].resolution=g,b[0].multisample=h,b[0].maskSprite=i;var l=c.filterArea;c.filterArea=i.getBounds(!0),d.filter.push(c,b),c.filterArea=l,!a._filters&&this.alphaMaskIndex++},a.prototype.popSpriteMask=function(a){this.renderer.filter.pop(),a._filters?a._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},a.prototype.destroy=function(){this.renderer=null},a}(),t=function(){function a(a){this.renderer=a,this.maskStack=[],this.glConst=0}return a.prototype.getStackLength=function(){return this.maskStack.length},a.prototype.setMaskStack=function(c){var a=this.renderer.gl,d=this.getStackLength();this.maskStack=c;var b=this.getStackLength();b!==d&&(0===b?a.disable(this.glConst):(a.enable(this.glConst),this._useCurrent()))},a.prototype._useCurrent=function(){},a.prototype.destroy=function(){this.renderer=null,this.maskStack=null},a}(),aZ=new a.y3,K=function(b){function a(c){var a=b.call(this,c)||this;return a.glConst=WebGLRenderingContext.SCISSOR_TEST,a}return aa(a,b),a.prototype.getStackLength=function(){var a=this.maskStack[this.maskStack.length-1];return a?a._scissorCounter:0},a.prototype.calcScissorRect=function(a){if(!a._scissorRectLocal){var f=a._scissorRect,c=a.maskObject,d=this.renderer,b=d.renderTexture;c.renderable=!0;var e=c.getBounds();this.roundFrameToPixels(e,b.current?b.current.resolution:d.resolution,b.sourceFrame,b.destinationFrame,d.projection.transform),c.renderable=!1,f&&e.fit(f),a._scissorRectLocal=e}},a.isMatrixRotated=function(a){if(!a)return!1;var b=a.a,c=a.b,d=a.c,e=a.d;return(Math.abs(c)>1e-4||Math.abs(d)>1e-4)&&(Math.abs(b)>1e-4||Math.abs(e)>1e-4)},a.prototype.testScissor=function(b){var c=b.maskObject;if(!c.isFastRect||!c.isFastRect()||a.isMatrixRotated(c.worldTransform)||a.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(b);var d=b._scissorRectLocal;return d.width>0&&d.height>0},a.prototype.roundFrameToPixels=function(b,e,f,c,d){!a.isMatrixRotated(d)&&((d=d?aZ.copyFrom(d):aZ.identity()).translate(-f.x,-f.y).scale(c.width/f.width,c.height/f.height).translate(c.x,c.y),this.renderer.filter.transformAABB(d,b),b.fit(c),b.x=Math.round(b.x*e),b.y=Math.round(b.y*e),b.width=Math.round(b.width*e),b.height=Math.round(b.height*e))},a.prototype.push=function(a){a._scissorRectLocal||this.calcScissorRect(a);var b=this.renderer.gl;a._scissorRect||b.enable(b.SCISSOR_TEST),a._scissorCounter++,a._scissorRect=a._scissorRectLocal,this._useCurrent()},a.prototype.pop=function(){var a=this.renderer.gl;this.getStackLength()>0?this._useCurrent():a.disable(a.SCISSOR_TEST)},a.prototype._useCurrent=function(){var b,a=this.maskStack[this.maskStack.length-1]._scissorRect;b=this.renderer.renderTexture.current?a.y:this.renderer.height-a.height-a.y,this.renderer.gl.scissor(a.x,b,a.width,a.height)},a}(t),L=function(b){function a(c){var a=b.call(this,c)||this;return a.glConst=WebGLRenderingContext.STENCIL_TEST,a}return aa(a,b),a.prototype.getStackLength=function(){var a=this.maskStack[this.maskStack.length-1];return a?a._stencilCounter:0},a.prototype.push=function(b){var c=b.maskObject,a=this.renderer.gl,d=b._stencilCounter;0===d&&(this.renderer.framebuffer.forceStencil(),a.clearStencil(0),a.clear(a.STENCIL_BUFFER_BIT),a.enable(a.STENCIL_TEST)),b._stencilCounter++,a.colorMask(!1,!1,!1,!1),a.stencilFunc(a.EQUAL,d,4294967295),a.stencilOp(a.KEEP,a.KEEP,a.INCR),c.renderable=!0,c.render(this.renderer),this.renderer.batch.flush(),c.renderable=!1,this._useCurrent()},a.prototype.pop=function(b){var a=this.renderer.gl;0===this.getStackLength()?a.disable(a.STENCIL_TEST):(a.colorMask(!1,!1,!1,!1),a.stencilOp(a.KEEP,a.KEEP,a.DECR),b.renderable=!0,b.render(this.renderer),this.renderer.batch.flush(),b.renderable=!1,this._useCurrent())},a.prototype._useCurrent=function(){var a=this.renderer.gl;a.colorMask(!0,!0,!0,!0),a.stencilFunc(a.EQUAL,this.getStackLength(),4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP)},a}(t),M=function(){function b(b){this.renderer=b,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new a.y3,this.transform=null}return b.prototype.update=function(b,c,d,e){this.destinationFrame=b||this.destinationFrame||this.defaultFrame,this.sourceFrame=c||this.sourceFrame||b,this.calculateProjection(this.destinationFrame,this.sourceFrame,d,e),this.transform&&this.projectionMatrix.append(this.transform);var a=this.renderer;a.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,a.globalUniforms.update(),a.shader.shader&&a.shader.syncUniformGroup(a.shader.shader.uniforms.globals)},b.prototype.calculateProjection=function(e,b,f,d){var a=this.projectionMatrix,c=d?-1:1;a.identity(),a.a=1/b.width*2,a.d=c*(1/b.height*2),a.tx=-1-b.x*a.a,a.ty=-c-b.y*a.d},b.prototype.setTransform=function(a){},b.prototype.destroy=function(){this.renderer=null},b}(),a$=new a.Ae,a_=new a.Ae,N=function(){function b(b){this.renderer=b,this.clearColor=b._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new a.Ae,this.destinationFrame=new a.Ae,this.viewportFrame=new a.Ae}return b.prototype.bind=function(a,c,b){void 0===a&&(a=null);var g,h,e,f=this.renderer;this.current=a,a?(e=(g=a.baseTexture).resolution,c||(a$.width=a.frame.width,a$.height=a.frame.height,c=a$),b||(a_.x=a.frame.x,a_.y=a.frame.y,a_.width=c.width,a_.height=c.height,b=a_),h=g.framebuffer):(e=f.resolution,c||(a$.width=f.screen.width,a$.height=f.screen.height,c=a$),b||((b=a$).width=c.width,b.height=c.height));var d=this.viewportFrame;d.x=b.x*e,d.y=b.y*e,d.width=b.width*e,d.height=b.height*e,a||(d.y=f.view.height-(d.y+d.height)),d.ceil(),this.renderer.framebuffer.bind(h,d),this.renderer.projection.update(b,c,e,!h),a?this.renderer.mask.setMaskStack(g.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(c),this.destinationFrame.copyFrom(b)},b.prototype.clear=function(a,j){a=this.current?a||this.current.baseTexture.clearColor:a||this.clearColor;var g=this.destinationFrame,h=this.current?this.current.baseTexture:this.renderer.screen,i=g.width!==h.width||g.height!==h.height;if(i){var b=this.viewportFrame,c=b.x,d=b.y,e=b.width,f=b.height;c=Math.round(c),d=Math.round(d),e=Math.round(e),f=Math.round(f),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(c,d,e,f)}this.renderer.framebuffer.clear(a[0],a[1],a[2],a[3],j),i&&this.renderer.scissor.pop()},b.prototype.resize=function(){this.bind(null)},b.prototype.reset=function(){this.bind(null)},b.prototype.destroy=function(){this.renderer=null},b}();function a0(c,d,a,e,b){a.buffer.update(b)}var a1={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},a2={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64},a3=function(){function a(a,b){this.program=a,this.uniformData=b,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return a.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},a}(),a4=0,a5={textureCount:0,uboCount:0},O=function(){function a(a){this.destroyed=!1,this.renderer=a,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=a4++}return a.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Y)return Y;try{var a=Function("param1","param2","param3","return param1[param2] === param3;");Y=!0===a({a:"b"},"a","b")}catch(b){Y=!1}return Y}())throw Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},a.prototype.contextChange=function(a){this.gl=a,this.reset()},a.prototype.bind=function(a,d){a.uniforms.globals=this.renderer.globalUniforms;var b=a.program,c=b.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(a);return this.shader=a,this.program!==b&&(this.program=b,this.gl.useProgram(c.program)),d||(a5.textureCount=0,a5.uboCount=0,this.syncUniformGroup(a.uniformGroup,a5)),c},a.prototype.setUniforms=function(b){var a=this.shader.program,c=a.glPrograms[this.renderer.CONTEXT_UID];a.syncUniforms(c.uniformData,b,this.renderer)},a.prototype.syncUniformGroup=function(a,c){var b=this.getGlProgram();a.static&&a.dirtyId===b.uniformDirtyGroups[a.id]||(b.uniformDirtyGroups[a.id]=a.dirtyId,this.syncUniforms(a,b,c))},a.prototype.syncUniforms=function(a,b,c){(a.syncUniforms[this.shader.program.id]||this.createSyncGroups(a))(b.uniformData,a.uniforms,this.renderer,c)},a.prototype.createSyncGroups=function(a){var b=this.getSignature(a,this.shader.program.uniformData,"u");return this.cache[b]||(this.cache[b]=function(c,i){var f,b=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var a in c.uniforms){var d=i[a];if(!d){(null===(f=c.uniforms[a])|| void 0===f?void 0:f.group)&&(c.uniforms[a].ubo?b.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+a+", '"+a+"');\n                    "):b.push("\n                        renderer.shader.syncUniformGroup(uv."+a+", syncData);\n                    "));continue}for(var g=c.uniforms[a],h=!1,e=0;e<aO.length;e++)if(aO[e].test(d,g)){b.push(aO[e].code(a,g)),h=!0;break}if(!h){var j=(1===d.size?aP:aQ)[d.type].replace("location",'ud["'+a+'"].location');b.push('\n            cu = ud["'+a+'"];\n            cv = cu.value;\n            v = uv["'+a+'"];\n            '+j+";")}}return Function("ud","uv","renderer","syncData",b.join("\n"))}(a,this.shader.program.uniformData)),a.syncUniforms[this.shader.program.id]=this.cache[b],a.syncUniforms[this.shader.program.id]},a.prototype.syncUniformBufferGroup=function(a,c){var b=this.getGlProgram();if(!a.static||0!==a.dirtyId||!b.uniformGroups[a.id]){a.dirtyId=0;var d=b.uniformGroups[a.id]||this.createSyncBufferGroup(a,b,c);a.buffer.update(),d(b.uniformData,a.uniforms,this.renderer,a5,a.buffer)}this.renderer.buffer.bindBufferBase(a.buffer,b.uniformBufferBindings[c])},a.prototype.createSyncBufferGroup=function(a,b,d){var f=this.renderer.gl;this.renderer.buffer.bind(a.buffer);var g=this.gl.getUniformBlockIndex(b.program,d);b.uniformBufferBindings[d]=this.shader.uniformBindCount,f.uniformBlockBinding(b.program,g,this.shader.uniformBindCount),this.shader.uniformBindCount++;var e=this.getSignature(a,this.shader.program.uniformData,"ubo"),c=this._uboCache[e];if(c||(c=this._uboCache[e]=function(e,n){if(!e.autoManage)return{size:0,syncFunc:a0};for(var g=function(h){for(var e=h.map(function(a){return{data:a,offset:0,dataLen:0,dirty:0}}),a=0,c=0,b=0,f=0;f<e.length;f++){var d=e[f];if(a=a2[d.data.type],d.data.size>1&&(a=Math.max(a,16)*d.data.size),d.dataLen=a,c%a!=0&&c<16){var g=c%a%16;c+=g,b+=g}c+a>16?(b=16*Math.ceil(b/16),d.offset=b,b+=a,c=a):(d.offset=b,c+=a,b+=a)}return{uboElements:e,size:b=16*Math.ceil(b/16)}}(function(d,b){var a=[];for(var c in d)b[c]&&a.push(b[c]);return a.sort(function(a,b){return a.index-b.index}),a}(e.uniforms,n)),h=g.uboElements,o=g.size,b=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],f=0;f<h.length;f++){for(var a=h[f],i=e.uniforms[a.data.name],c=a.data.name,j=!1,d=0;d<aO.length;d++){var k=aO[d];if(k.codeUbo&&k.test(a.data,i)){b.push("offset = "+a.offset/4+";",aO[d].codeUbo(a.data.name,i)),j=!0;break}}if(!j){if(a.data.size>1){var p=aK(a.data.type),l=Math.max(a2[a.data.type]/16,1),m=p/l,q=(4-m%4)%4;b.push("\n                cv = ud."+c+".value;\n                v = uv."+c+";\n                offset = "+a.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+a.data.size*l+"; i++)\n                {\n                    for(var j = 0; j < "+m+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+q+";\n                }\n\n                ")}else{var r=a1[a.data.type];b.push("\n                cv = ud."+c+".value;\n                v = uv."+c+";\n                offset = "+a.offset/4+";\n                "+r+";\n                ")}}}return b.push("\n       renderer.buffer.update(buffer);\n    "),{size:o,syncFunc:Function("ud","uv","renderer","syncData","buffer",b.join("\n"))}}(a,this.shader.program.uniformData)),a.autoManage){var h=new Float32Array(c.size/4);a.buffer.update(h)}return b.uniformGroups[a.id]=c.syncFunc,b.uniformGroups[a.id]},a.prototype.getSignature=function(d,c,e){var f=d.uniforms,a=[e+"-"];for(var b in f)a.push(b),c[b]&&a.push(c[b].type);return a.join("-")},a.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},a.prototype.generateProgram=function(c){var d=this.gl,a=c.program,b=function(a,e){var b,f,h,i,j=aD(a,a.VERTEX_SHADER,e.vertexSrc),k=aD(a,a.FRAGMENT_SHADER,e.fragmentSrc),c=a.createProgram();if(a.attachShader(c,j),a.attachShader(c,k),a.linkProgram(c),!a.getProgramParameter(c,a.LINK_STATUS)&&(b=a,f=c,h=j,i=k,b.getProgramParameter(f,b.LINK_STATUS)||(b.getShaderParameter(h,b.COMPILE_STATUS)||aE(b,h),b.getShaderParameter(i,b.COMPILE_STATUS)||aE(b,i),console.error("PixiJS Error: Could not initialize shader."),""!==b.getProgramInfoLog(f)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",b.getProgramInfoLog(f)))),e.attributeData=function(c,a){for(var e={},g=a.getProgramParameter(c,a.ACTIVE_ATTRIBUTES),d=0;d<g;d++){var b=a.getActiveAttrib(c,d);if(0!==b.name.indexOf("gl_")){var f=aN(a,b.type),h={type:f,name:b.name,size:aK(f),location:a.getAttribLocation(c,b.name)};e[b.name]=h}}return e}(c,a),e.uniformData=function(d,b){for(var e={},h=b.getProgramParameter(d,b.ACTIVE_UNIFORMS),c=0;c<h;c++){var a=b.getActiveUniform(d,c),f=a.name.replace(/\[.*?\]$/,""),i=!!a.name.match(/\[.*?\]$/),g=aN(b,a.type);e[f]={name:f,index:c,type:g,size:a.size,isArray:i,value:aG(g,a.size)}}return e}(c,a),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var g=Object.keys(e.attributeData);g.sort(function(a,b){return a>b?1:-1});for(var d=0;d<g.length;d++)e.attributeData[g[d]].location=d,a.bindAttribLocation(c,d,g[d]);a.linkProgram(c)}a.deleteShader(j),a.deleteShader(k);var l={};for(var d in e.uniformData){var m=e.uniformData[d];l[d]={location:a.getUniformLocation(c,d),value:aG(m.type,m.size)}}return new a3(c,l)}(d,a);return a.glPrograms[this.renderer.CONTEXT_UID]=b,b},a.prototype.reset=function(){this.program=null,this.shader=null},a.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},a}(),P=function(){function a(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=d.T$.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new aV,this.defaultState.blend=!0}return a.prototype.contextChange=function(c){var a,b;this.gl=c,this.blendModes=(a=c,void 0===b&&(b=[]),b[d.T$.NORMAL]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.ADD]=[a.ONE,a.ONE],b[d.T$.MULTIPLY]=[a.DST_COLOR,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.SCREEN]=[a.ONE,a.ONE_MINUS_SRC_COLOR,a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.OVERLAY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.DARKEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.LIGHTEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.COLOR_DODGE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.COLOR_BURN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.HARD_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.SOFT_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.DIFFERENCE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.EXCLUSION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.HUE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.SATURATION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.COLOR]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.LUMINOSITY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.NONE]=[0,0],b[d.T$.NORMAL_NPM]=[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.ADD_NPM]=[a.SRC_ALPHA,a.ONE,a.ONE,a.ONE],b[d.T$.SCREEN_NPM]=[a.SRC_ALPHA,a.ONE_MINUS_SRC_COLOR,a.ONE,a.ONE_MINUS_SRC_ALPHA],b[d.T$.SRC_IN]=[a.DST_ALPHA,a.ZERO],b[d.T$.SRC_OUT]=[a.ONE_MINUS_DST_ALPHA,a.ZERO],b[d.T$.SRC_ATOP]=[a.DST_ALPHA,a.ONE_MINUS_SRC_ALPHA],b[d.T$.DST_OVER]=[a.ONE_MINUS_DST_ALPHA,a.ONE],b[d.T$.DST_IN]=[a.ZERO,a.SRC_ALPHA],b[d.T$.DST_OUT]=[a.ZERO,a.ONE_MINUS_SRC_ALPHA],b[d.T$.DST_ATOP]=[a.ONE_MINUS_DST_ALPHA,a.SRC_ALPHA],b[d.T$.XOR]=[a.ONE_MINUS_DST_ALPHA,a.ONE_MINUS_SRC_ALPHA],b[d.T$.SUBTRACT]=[a.ONE,a.ONE,a.ONE,a.ONE,a.FUNC_REVERSE_SUBTRACT,a.FUNC_ADD],b),this.set(this.defaultState),this.reset()},a.prototype.set=function(a){if(a=a||this.defaultState,this.stateId!==a.data){for(var c=this.stateId^a.data,b=0;c;)1&c&&this.map[b].call(this,!!(a.data&1<<b)),c>>=1,b++;this.stateId=a.data}for(var b=0;b<this.checks.length;b++)this.checks[b](this,a)},a.prototype.forceState=function(b){b=b||this.defaultState;for(var a=0;a<this.map.length;a++)this.map[a].call(this,!!(b.data&1<<a));for(var a=0;a<this.checks.length;a++)this.checks[a](this,b);this.stateId=b.data},a.prototype.setBlend=function(b){this.updateCheck(a.checkBlendMode,b),this.gl[b?"enable":"disable"](this.gl.BLEND)},a.prototype.setOffset=function(b){this.updateCheck(a.checkPolygonOffset,b),this.gl[b?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},a.prototype.setDepthTest=function(a){this.gl[a?"enable":"disable"](this.gl.DEPTH_TEST)},a.prototype.setDepthMask=function(a){this.gl.depthMask(a)},a.prototype.setCullFace=function(a){this.gl[a?"enable":"disable"](this.gl.CULL_FACE)},a.prototype.setFrontFace=function(a){this.gl.frontFace(this.gl[a?"CW":"CCW"])},a.prototype.setBlendMode=function(c){if(c!==this.blendMode){this.blendMode=c;var a=this.blendModes[c],b=this.gl;2===a.length?b.blendFunc(a[0],a[1]):b.blendFuncSeparate(a[0],a[1],a[2],a[3]),6===a.length?(this._blendEq=!0,b.blendEquationSeparate(a[4],a[5])):this._blendEq&&(this._blendEq=!1,b.blendEquationSeparate(b.FUNC_ADD,b.FUNC_ADD))}},a.prototype.setPolygonOffset=function(a,b){this.gl.polygonOffset(a,b)},a.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},a.prototype.updateCheck=function(b,c){var a=this.checks.indexOf(b);c&& -1===a?this.checks.push(b):c|| -1===a||this.checks.splice(a,1)},a.checkBlendMode=function(a,b){a.setBlendMode(b.blendMode)},a.checkPolygonOffset=function(a,b){a.setPolygonOffset(1,b.polygonOffset)},a.prototype.destroy=function(){this.gl=null},a}(),Q=function(){function a(a){this.renderer=a,this.count=0,this.checkCount=0,this.maxIdle=k.X.GC_MAX_IDLE,this.checkCountMax=k.X.GC_MAX_CHECK_COUNT,this.mode=k.X.GC_MODE}return a.prototype.postrender=function(){if(this.renderer.renderingToScreen)this.count++,this.mode!==d.UN.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},a.prototype.run=function(){for(var d=this.renderer.texture,b=d.managedTextures,e=!1,a=0;a<b.length;a++){var c=b[a];!c.framebuffer&&this.count-c.touched>this.maxIdle&&(d.destroyTexture(c,!0),b[a]=null,e=!0)}if(e){for(var f=0,a=0;a<b.length;a++)null!==b[a]&&(b[f++]=b[a]);b.length=f}},a.prototype.unload=function(a){var d=this.renderer.texture,b=a._texture;b&&!b.framebuffer&&d.destroyTexture(b);for(var c=a.children.length-1;c>=0;c--)this.unload(a.children[c])},a.prototype.destroy=function(){this.renderer=null},a}(),a6=function(a){this.texture=a,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=d.vK.UNSIGNED_BYTE,this.internalFormat=d.I2.RGBA,this.samplerType=0},R=function(){function a(a){this.renderer=a,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new w,this.hasIntegerTextures=!1}return a.prototype.contextChange=function(){var a,c,e,g,h,l,i,m,j,n,q,r,s,p,t,u,v,w,o,k,x,y,z,C,b=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=(a=b,"WebGL2RenderingContext"in globalThis&&a instanceof globalThis.WebGL2RenderingContext?((c={})[d.vK.UNSIGNED_BYTE]=((e={})[d.I2.RGBA]=a.RGBA8,e[d.I2.RGB]=a.RGB8,e[d.I2.RG]=a.RG8,e[d.I2.RED]=a.R8,e[d.I2.RGBA_INTEGER]=a.RGBA8UI,e[d.I2.RGB_INTEGER]=a.RGB8UI,e[d.I2.RG_INTEGER]=a.RG8UI,e[d.I2.RED_INTEGER]=a.R8UI,e[d.I2.ALPHA]=a.ALPHA,e[d.I2.LUMINANCE]=a.LUMINANCE,e[d.I2.LUMINANCE_ALPHA]=a.LUMINANCE_ALPHA,e),c[d.vK.BYTE]=((g={})[d.I2.RGBA]=a.RGBA8_SNORM,g[d.I2.RGB]=a.RGB8_SNORM,g[d.I2.RG]=a.RG8_SNORM,g[d.I2.RED]=a.R8_SNORM,g[d.I2.RGBA_INTEGER]=a.RGBA8I,g[d.I2.RGB_INTEGER]=a.RGB8I,g[d.I2.RG_INTEGER]=a.RG8I,g[d.I2.RED_INTEGER]=a.R8I,g),c[d.vK.UNSIGNED_SHORT]=((h={})[d.I2.RGBA_INTEGER]=a.RGBA16UI,h[d.I2.RGB_INTEGER]=a.RGB16UI,h[d.I2.RG_INTEGER]=a.RG16UI,h[d.I2.RED_INTEGER]=a.R16UI,h[d.I2.DEPTH_COMPONENT]=a.DEPTH_COMPONENT16,h),c[d.vK.SHORT]=((l={})[d.I2.RGBA_INTEGER]=a.RGBA16I,l[d.I2.RGB_INTEGER]=a.RGB16I,l[d.I2.RG_INTEGER]=a.RG16I,l[d.I2.RED_INTEGER]=a.R16I,l),c[d.vK.UNSIGNED_INT]=((i={})[d.I2.RGBA_INTEGER]=a.RGBA32UI,i[d.I2.RGB_INTEGER]=a.RGB32UI,i[d.I2.RG_INTEGER]=a.RG32UI,i[d.I2.RED_INTEGER]=a.R32UI,i[d.I2.DEPTH_COMPONENT]=a.DEPTH_COMPONENT24,i),c[d.vK.INT]=((m={})[d.I2.RGBA_INTEGER]=a.RGBA32I,m[d.I2.RGB_INTEGER]=a.RGB32I,m[d.I2.RG_INTEGER]=a.RG32I,m[d.I2.RED_INTEGER]=a.R32I,m),c[d.vK.FLOAT]=((j={})[d.I2.RGBA]=a.RGBA32F,j[d.I2.RGB]=a.RGB32F,j[d.I2.RG]=a.RG32F,j[d.I2.RED]=a.R32F,j[d.I2.DEPTH_COMPONENT]=a.DEPTH_COMPONENT32F,j),c[d.vK.HALF_FLOAT]=((n={})[d.I2.RGBA]=a.RGBA16F,n[d.I2.RGB]=a.RGB16F,n[d.I2.RG]=a.RG16F,n[d.I2.RED]=a.R16F,n),c[d.vK.UNSIGNED_SHORT_5_6_5]=((q={})[d.I2.RGB]=a.RGB565,q),c[d.vK.UNSIGNED_SHORT_4_4_4_4]=((r={})[d.I2.RGBA]=a.RGBA4,r),c[d.vK.UNSIGNED_SHORT_5_5_5_1]=((s={})[d.I2.RGBA]=a.RGB5_A1,s),c[d.vK.UNSIGNED_INT_2_10_10_10_REV]=((p={})[d.I2.RGBA]=a.RGB10_A2,p[d.I2.RGBA_INTEGER]=a.RGB10_A2UI,p),c[d.vK.UNSIGNED_INT_10F_11F_11F_REV]=((t={})[d.I2.RGB]=a.R11F_G11F_B10F,t),c[d.vK.UNSIGNED_INT_5_9_9_9_REV]=((u={})[d.I2.RGB]=a.RGB9_E5,u),c[d.vK.UNSIGNED_INT_24_8]=((v={})[d.I2.DEPTH_STENCIL]=a.DEPTH24_STENCIL8,v),c[d.vK.FLOAT_32_UNSIGNED_INT_24_8_REV]=((w={})[d.I2.DEPTH_STENCIL]=a.DEPTH32F_STENCIL8,w),c):((o={})[d.vK.UNSIGNED_BYTE]=((k={})[d.I2.RGBA]=a.RGBA,k[d.I2.RGB]=a.RGB,k[d.I2.ALPHA]=a.ALPHA,k[d.I2.LUMINANCE]=a.LUMINANCE,k[d.I2.LUMINANCE_ALPHA]=a.LUMINANCE_ALPHA,k),o[d.vK.UNSIGNED_SHORT_5_6_5]=((x={})[d.I2.RGB]=a.RGB,x),o[d.vK.UNSIGNED_SHORT_4_4_4_4]=((y={})[d.I2.RGBA]=a.RGBA,y),o[d.vK.UNSIGNED_SHORT_5_5_5_1]=((z={})[d.I2.RGBA]=a.RGBA,z),o));var A=b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=A;for(var f=0;f<A;f++)this.boundTextures[f]=null;this.emptyTextures={};var B=new a6(b.createTexture());b.bindTexture(b.TEXTURE_2D,B.texture),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[b.TEXTURE_2D]=B,this.emptyTextures[b.TEXTURE_CUBE_MAP]=new a6(b.createTexture()),b.bindTexture(b.TEXTURE_CUBE_MAP,this.emptyTextures[b.TEXTURE_CUBE_MAP].texture);for(var f=0;f<6;f++)b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+f,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,null);b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MIN_FILTER,b.LINEAR);for(var f=0;f<this.boundTextures.length;f++)this.bind(null,f)},a.prototype.bind=function(b,a){void 0===a&&(a=0);var c=this.gl;if((b=null==b?void 0:b.castToBaseTexture())&&b.valid&&!b.parentTextureArray){b.touched=this.renderer.textureGC.count;var d=b._glTextures[this.CONTEXT_UID]||this.initTexture(b);this.boundTextures[a]!==b&&(this.currentLocation!==a&&(this.currentLocation=a,c.activeTexture(c.TEXTURE0+a)),c.bindTexture(b.target,d.texture)),d.dirtyId!==b.dirtyId&&(this.currentLocation!==a&&(this.currentLocation=a,c.activeTexture(c.TEXTURE0+a)),this.updateTexture(b)),this.boundTextures[a]=b}else this.currentLocation!==a&&(this.currentLocation=a,c.activeTexture(c.TEXTURE0+a)),c.bindTexture(c.TEXTURE_2D,this.emptyTextures[c.TEXTURE_2D].texture),this.boundTextures[a]=null},a.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var a=0;a<this.boundTextures.length;a++)this.boundTextures[a]=this.unknownTexture},a.prototype.unbind=function(c){var d=this.gl,b=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var a=0;a<b.length;a++)b[a]===this.unknownTexture&&this.bind(null,a)}for(var a=0;a<b.length;a++)b[a]===c&&(this.currentLocation!==a&&(d.activeTexture(d.TEXTURE0+a),this.currentLocation=a),d.bindTexture(c.target,this.emptyTextures[c.target].texture),b[a]=null)},a.prototype.ensureSamplerType=function(c){var e=this.boundTextures,f=this.hasIntegerTextures,g=this.CONTEXT_UID;if(f)for(var a=c-1;a>=0;--a){var b=e[a];b&&b._glTextures[g].samplerType!==d.oT.FLOAT&&this.renderer.texture.unbind(b)}},a.prototype.initTexture=function(a){var b=new a6(this.gl.createTexture());return b.dirtyId=-1,a._glTextures[this.CONTEXT_UID]=b,this.managedTextures.push(a),a.on("dispose",this.destroyTexture,this),b},a.prototype.initTextureType=function(a,b){var c,e;b.internalFormat=null!==(e=null===(c=this.internalFormats[a.type])|| void 0===c?void 0:c[a.format])&& void 0!==e?e:a.format,2===this.webGLVersion&&a.type===d.vK.HALF_FLOAT?b.type=this.gl.HALF_FLOAT:b.type=a.type},a.prototype.updateTexture=function(b){var a=b._glTextures[this.CONTEXT_UID];if(a){var f=this.renderer;if(this.initTextureType(b,a),b.resource&&b.resource.upload(f,b,a))a.samplerType!==d.oT.FLOAT&&(this.hasIntegerTextures=!0);else{var c=b.realWidth,e=b.realHeight,g=f.gl;(a.width!==c||a.height!==e||a.dirtyId<0)&&(a.width=c,a.height=e,g.texImage2D(b.target,0,a.internalFormat,c,e,0,b.format,a.type,null))}b.dirtyStyleId!==a.dirtyStyleId&&this.updateTextureStyle(b),a.dirtyId=b.dirtyId}},a.prototype.destroyTexture=function(a,c){var d=this.gl;if((a=a.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(a),d.deleteTexture(a._glTextures[this.CONTEXT_UID].texture),a.off("dispose",this.destroyTexture,this),delete a._glTextures[this.CONTEXT_UID],!c)){var b=this.managedTextures.indexOf(a);-1!==b&&(0,e.Er)(this.managedTextures,b,1)}},a.prototype.updateTextureStyle=function(a){var b=a._glTextures[this.CONTEXT_UID];b&&(a.mipmap!==d.WB.POW2&&2===this.webGLVersion||a.isPowerOfTwo?b.mipmap=a.mipmap>=1:b.mipmap=!1,2===this.webGLVersion||a.isPowerOfTwo?b.wrapMode=a.wrapMode:b.wrapMode=d.Nt.CLAMP,a.resource&&a.resource.style(this.renderer,a,b)||this.setStyle(a,b),b.dirtyStyleId=a.dirtyStyleId)},a.prototype.setStyle=function(b,c){var a=this.gl;if(c.mipmap&&b.mipmap!==d.WB.ON_MANUAL&&a.generateMipmap(b.target),a.texParameteri(b.target,a.TEXTURE_WRAP_S,c.wrapMode),a.texParameteri(b.target,a.TEXTURE_WRAP_T,c.wrapMode),c.mipmap){a.texParameteri(b.target,a.TEXTURE_MIN_FILTER,b.scaleMode===d.aH.LINEAR?a.LINEAR_MIPMAP_LINEAR:a.NEAREST_MIPMAP_NEAREST);var e=this.renderer.context.extensions.anisotropicFiltering;if(e&&b.anisotropicLevel>0&&b.scaleMode===d.aH.LINEAR){var f=Math.min(b.anisotropicLevel,a.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT));a.texParameterf(b.target,e.TEXTURE_MAX_ANISOTROPY_EXT,f)}}else a.texParameteri(b.target,a.TEXTURE_MIN_FILTER,b.scaleMode===d.aH.LINEAR?a.LINEAR:a.NEAREST);a.texParameteri(b.target,a.TEXTURE_MAG_FILTER,b.scaleMode===d.aH.LINEAR?a.LINEAR:a.NEAREST)},a.prototype.destroy=function(){this.renderer=null},a}(),S={__proto__:null,FilterSystem:A,BatchSystem:C,ContextSystem:D,FramebufferSystem:E,GeometrySystem:F,MaskSystem:J,ScissorSystem:K,StencilSystem:L,ProjectionSystem:M,RenderTextureSystem:N,ShaderSystem:O,StateSystem:P,TextureGCSystem:Q,TextureSystem:R},a7=new a.y3,T=function(c){function b(g,f){void 0===g&&(g=d.N3.UNKNOWN);var b=c.call(this)||this;return f=Object.assign({},k.X.RENDER_OPTIONS,f),b.options=f,b.type=g,b.screen=new a.Ae(0,0,f.width,f.height),b.view=f.view||document.createElement("canvas"),b.resolution=f.resolution||k.X.RESOLUTION,b.useContextAlpha=f.useContextAlpha,b.autoDensity=!!f.autoDensity,b.preserveDrawingBuffer=f.preserveDrawingBuffer,b.clearBeforeRender=f.clearBeforeRender,b._backgroundColor=0,b._backgroundColorRgba=[0,0,0,1],b._backgroundColorString="#000000",b.backgroundColor=f.backgroundColor||b._backgroundColor,b.backgroundAlpha=f.backgroundAlpha,void 0!==f.transparent&&((0,e.a1)("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),b.useContextAlpha=f.transparent,b.backgroundAlpha=f.transparent?0:1),b._lastObjectRendered=null,b.plugins={},b}return aa(b,c),b.prototype.initPlugins=function(a){for(var b in a)this.plugins[b]=new a[b](this)},Object.defineProperty(b.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),b.prototype.resize=function(c,d){this.view.width=Math.round(c*this.resolution),this.view.height=Math.round(d*this.resolution);var a=this.view.width/this.resolution,b=this.view.height/this.resolution;this.screen.width=a,this.screen.height=b,this.autoDensity&&(this.view.style.width=a+"px",this.view.style.height=b+"px"),this.emit("resize",a,b)},b.prototype.generateTexture=function(c,b,f,a){void 0===b&&(b={}),"number"==typeof b&&((0,e.a1)("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),b={scaleMode:b,resolution:f,region:a});var g=b.region,h=function(b,e){var d={};for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&0>e.indexOf(a)&&(d[a]=b[a]);if(null!=b&&"function"==typeof Object.getOwnPropertySymbols)for(var c=0,a=Object.getOwnPropertySymbols(b);c<a.length;c++)0>e.indexOf(a[c])&&(d[a[c]]=b[a[c]]);return d}(b,["region"]);0===(a=g||c.getLocalBounds(null,!0)).width&&(a.width=1),0===a.height&&(a.height=1);var d=ai.create(ab({width:a.width,height:a.height},h));return a7.tx=-a.x,a7.ty=-a.y,this.render(c,{renderTexture:d,clear:!1,transform:a7,skipUpdateTransform:!!c.parent}),d},b.prototype.destroy=function(c){for(var b in this.plugins)this.plugins[b].destroy(),this.plugins[b]=null;c&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var a=this;a.plugins=null,a.type=d.N3.UNKNOWN,a.view=null,a.screen=null,a._tempDisplayObjectParent=null,a.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(b.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a,this._backgroundColorString=(0,e.XN)(a),(0,e.wK)(a,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(a){this._backgroundColorRgba[3]=a},enumerable:!1,configurable:!0}),b}(e.vp),a8=function(a){this.buffer=a||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},a9=function(){function a(a){this.renderer=a,this.managedBuffers={},this.boundBufferBases={}}return a.prototype.destroy=function(){this.renderer=null},a.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},a.prototype.bind=function(a){var b=this.gl,c=this.CONTEXT_UID,d=a._glBuffers[c]||this.createGLBuffer(a);b.bindBuffer(a.type,d.buffer)},a.prototype.bindBufferBase=function(a,b){var c=this.gl,d=this.CONTEXT_UID;if(this.boundBufferBases[b]!==a){var e=a._glBuffers[d]||this.createGLBuffer(a);this.boundBufferBases[b]=a,c.bindBufferBase(c.UNIFORM_BUFFER,b,e.buffer)}},a.prototype.bindBufferRange=function(b,d,a){var c=this.gl,e=this.CONTEXT_UID;a=a||0;var f=b._glBuffers[e]||this.createGLBuffer(b);c.bindBufferRange(c.UNIFORM_BUFFER,d||0,f.buffer,256*a,256)},a.prototype.update=function(a){var b=this.gl,d=this.CONTEXT_UID,c=a._glBuffers[d];if(a._updateID!==c.updateID){if(c.updateID=a._updateID,b.bindBuffer(a.type,c.buffer),c.byteLength>=a.data.byteLength)b.bufferSubData(a.type,0,a.data);else{var e=a.static?b.STATIC_DRAW:b.DYNAMIC_DRAW;c.byteLength=a.data.byteLength,b.bufferData(a.type,a.data,e)}}},a.prototype.dispose=function(a,c){if(this.managedBuffers[a.id]){delete this.managedBuffers[a.id];var b=a._glBuffers[this.CONTEXT_UID],d=this.gl;a.disposeRunner.remove(this),b&&(c||d.deleteBuffer(b.buffer),delete a._glBuffers[this.CONTEXT_UID])}},a.prototype.disposeAll=function(c){for(var b=Object.keys(this.managedBuffers),a=0;a<b.length;a++)this.dispose(this.managedBuffers[b[a]],c)},a.prototype.createGLBuffer=function(a){var b=this.CONTEXT_UID,c=this.gl;return a._glBuffers[b]=new a8(c.createBuffer()),this.managedBuffers[a.id]=a,a.disposeRunner.add(this),a._glBuffers[b]},a}(),ba=function(c){function b(g){var f=c.call(this,d.N3.WEBGL,g)||this;return g=f.options,f.gl=null,f.CONTEXT_UID=0,f.runners={destroy:new Z.R("destroy"),contextChange:new Z.R("contextChange"),reset:new Z.R("reset"),update:new Z.R("update"),postrender:new Z.R("postrender"),prerender:new Z.R("prerender"),resize:new Z.R("resize")},f.runners.contextChange.add(f),f.globalUniforms=new au({projectionMatrix:new a.y3},!0),f.addSystem(J,"mask").addSystem(D,"context").addSystem(P,"state").addSystem(O,"shader").addSystem(R,"texture").addSystem(a9,"buffer").addSystem(F,"geometry").addSystem(E,"framebuffer").addSystem(K,"scissor").addSystem(L,"stencil").addSystem(M,"projection").addSystem(Q,"textureGC").addSystem(A,"filter").addSystem(N,"renderTexture").addSystem(C,"batch"),f.initPlugins(b.__plugins),f.multisample=void 0,g.context?f.context.initFromContext(g.context):f.context.initFromOptions({alpha:!!f.useContextAlpha,antialias:g.antialias,premultipliedAlpha:f.useContextAlpha&&"notMultiplied"!==f.useContextAlpha,stencil:!0,preserveDrawingBuffer:g.preserveDrawingBuffer,powerPreference:f.options.powerPreference}),f.renderingToScreen=!0,(0,e.DE)(2===f.context.webGLVersion?"WebGL 2":"WebGL 1"),f.resize(f.options.width,f.options.height),f}return aa(b,c),b.create=function(a){if((0,e.HR)())return new b(a);throw Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},b.prototype.contextChange=function(){var b,a=this.gl;if(1===this.context.webGLVersion){var c=a.getParameter(a.FRAMEBUFFER_BINDING);a.bindFramebuffer(a.FRAMEBUFFER,null),b=a.getParameter(a.SAMPLES),a.bindFramebuffer(a.FRAMEBUFFER,c)}else{var c=a.getParameter(a.DRAW_FRAMEBUFFER_BINDING);a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),b=a.getParameter(a.SAMPLES),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,c)}b>=d.G5.HIGH?this.multisample=d.G5.HIGH:b>=d.G5.MEDIUM?this.multisample=d.G5.MEDIUM:b>=d.G5.LOW?this.multisample=d.G5.LOW:this.multisample=d.G5.NONE},b.prototype.addSystem=function(c,a){var b=new c(this);if(this[a])throw Error('Whoops! The name "'+a+'" is already in use');for(var d in this[a]=b,this.runners)this.runners[d].add(b);return this},b.prototype.render=function(b,a){if(a&&(a instanceof ai?((0,e.a1)("6.0.0","Renderer#render arguments changed, use options instead."),c=a,d=arguments[2],g=arguments[3],h=arguments[4]):(c=a.renderTexture,d=a.clear,g=a.transform,h=a.skipUpdateTransform)),this.renderingToScreen=!c,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=g,!this.context.isLost){if(c||(this._lastObjectRendered=b),!h){var c,d,g,h,f=b.enableTempParent();b.updateTransform(),b.disableTempParent(f)}this.renderTexture.bind(c),this.batch.currentRenderer.start(),(void 0!==d?d:this.clearBeforeRender)&&this.renderTexture.clear(),b.render(this),this.batch.currentRenderer.flush(),c&&c.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},b.prototype.generateTexture=function(b,a,d,e){void 0===a&&(a={});var f=c.prototype.generateTexture.call(this,b,a,d,e);return this.framebuffer.blit(),f},b.prototype.resize=function(a,b){c.prototype.resize.call(this,a,b),this.runners.resize.emit(this.screen.height,this.screen.width)},b.prototype.reset=function(){return this.runners.reset.emit(),this},b.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},b.prototype.destroy=function(a){for(var b in this.runners.destroy.emit(),this.runners)this.runners[b].destroy();c.prototype.destroy.call(this,a),this.gl=null},Object.defineProperty(b.prototype,"extract",{get:function(){return(0,e.a1)("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),b.registerPlugin=function(a,c){b.__plugins=b.__plugins||{},b.__plugins[a]=c},b}(T);function bb(a){return ba.create(a)}var bc="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",bd="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";(function b(a){(0,e.a1)("6.1.0","System class is deprecated, implemement ISystem interface instead."),this.renderer=a}).prototype.destroy=function(){this.renderer=null};var be=function(){this.texArray=null,this.blend=0,this.type=d.lg.TRIANGLES,this.start=0,this.size=0,this.data=null},bf=function(){function a(){this.elements=[],this.ids=[],this.count=0}return a.prototype.clear=function(){for(var a=0;a<this.count;a++)this.elements[a]=null;this.count=0},a}(),bg=function(){function a(a){"number"==typeof a?this.rawBinaryData=new ArrayBuffer(a):a instanceof Uint8Array?this.rawBinaryData=a.buffer:this.rawBinaryData=a,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(a.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),a.prototype.view=function(a){return this[a+"View"]},a.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},a.sizeOf=function(a){switch(a){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw Error(a+" isn't a valid view type")}},a}(),bh=function(b){function a(c){var a=b.call(this,c)||this;return a.shaderGenerator=null,a.geometryClass=null,a.vertexSize=null,a.state=aV.for2d(),a.size=4*k.X.SPRITE_BATCH_SIZE,a._vertexCount=0,a._indexCount=0,a._bufferedElements=[],a._bufferedTextures=[],a._bufferSize=0,a._shader=null,a._packedGeometries=[],a._packedGeometryPoolSize=2,a._flushId=0,a._aBuffers={},a._iBuffers={},a.MAX_TEXTURES=1,a.renderer.on("prerender",a.onPrerender,a),c.runners.contextChange.add(a),a._dcIndex=0,a._aIndex=0,a._iIndex=0,a._attributeBuffer=null,a._indexBuffer=null,a._tempBoundTextures=[],a}return aa(a,b),a.prototype.contextChange=function(){var a=this.renderer.gl;k.X.PREFER_ENV===d.Vi.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),k.X.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(b,a){if(0===b)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var c=a.createShader(a.FRAGMENT_SHADER);;){var d="precision mediump float;\nvoid main(void){\nfloat test = 0.1;\n%forloop%\ngl_FragColor = vec4(0.0);\n}".replace(/%forloop%/gi,aR(b));if(a.shaderSource(c,d),a.compileShader(c),a.getShaderParameter(c,a.COMPILE_STATUS))break;b=b/2|0}return b}(this.MAX_TEXTURES,a)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var b=0;b<this._packedGeometryPoolSize;b++)this._packedGeometries[b]=new this.geometryClass;this.initFlushBuffers()},a.prototype.initFlushBuffers=function(){for(var c=a._drawCallPool,d=a._textureArrayPool,e=this.size/4,f=Math.floor(e/this.MAX_TEXTURES)+1;c.length<e;)c.push(new be);for(;d.length<f;)d.push(new bf);for(var b=0;b<this.MAX_TEXTURES;b++)this._tempBoundTextures[b]=null},a.prototype.onPrerender=function(){this._flushId=0},a.prototype.render=function(a){a._texture.valid&&(this._vertexCount+a.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=a.vertexData.length/2,this._indexCount+=a.indices.length,this._bufferedTextures[this._bufferSize]=a._texture.baseTexture,this._bufferedElements[this._bufferSize++]=a)},a.prototype.buildTexturesAndDrawCalls=function(){var j=this,k=j._bufferedTextures,f=j.MAX_TEXTURES,l=a._textureArrayPool,h=this.renderer.batch,e=this._tempBoundTextures,n=this.renderer.textureGC.count,d=++w._globalBatch,m=0,c=l[0],i=0;h.copyBoundTextures(e,f);for(var b=0;b<this._bufferSize;++b){var g=k[b];k[b]=null,g._batchEnabled!==d&&(c.count>=f&&(h.boundArray(c,e,d,f),this.buildDrawCalls(c,i,b),i=b,c=l[++m],++d),g._batchEnabled=d,g.touched=n,c.elements[c.count++]=g)}c.count>0&&(h.boundArray(c,e,d,f),this.buildDrawCalls(c,i,this._bufferSize),++m,++d);for(var b=0;b<e.length;b++)e[b]=null;w._globalBatch=d},a.prototype.buildDrawCalls=function(j,g,k){var l=this._bufferedElements,o=this._attributeBuffer,p=this._indexBuffer,q=this.vertexSize,m=a._drawCallPool,h=this._dcIndex,i=this._aIndex,c=this._iIndex,b=m[h];b.start=this._iIndex,b.texArray=j;for(var d=g;d<k;++d){var f=l[d],r=f._texture.baseTexture,n=e.YA[r.alphaMode?1:0][f.blendMode];l[d]=null,g<d&&b.blend!==n&&(b.size=c-b.start,g=d,(b=m[++h]).texArray=j,b.start=c),this.packInterleavedGeometry(f,o,p,i,c),i+=f.vertexData.length/2*q,c+=f.indices.length,b.blend=n}g<k&&(b.size=c-b.start,++h),this._dcIndex=h,this._aIndex=i,this._iIndex=c},a.prototype.bindAndClearTexArray=function(a){for(var c=this.renderer.texture,b=0;b<a.count;b++)c.bind(a.elements[b],a.ids[b]),a.elements[b]=null;a.count=0},a.prototype.updateGeometry=function(){var a=this._packedGeometries,b=this._attributeBuffer,c=this._indexBuffer;k.X.CAN_UPLOAD_SAME_BUFFER?(a[this._flushId]._buffer.update(b.rawBinaryData),a[this._flushId]._indexBuffer.update(c),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,a[this._flushId]=new this.geometryClass),a[this._flushId]._buffer.update(b.rawBinaryData),a[this._flushId]._indexBuffer.update(c),this.renderer.geometry.bind(a[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},a.prototype.drawBatches=function(){for(var h=this._dcIndex,e=this.renderer,f=e.gl,i=e.state,j=a._drawCallPool,g=null,c=0;c<h;c++){var b=j[c],d=b.texArray,k=b.type,l=b.size,m=b.start,n=b.blend;g!==d&&(g=d,this.bindAndClearTexArray(d)),this.state.blendMode=n,i.set(this.state),f.drawElements(k,l,f.UNSIGNED_SHORT,2*m)}},a.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},a.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),k.X.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},a.prototype.stop=function(){this.flush()},a.prototype.destroy=function(){for(var a=0;a<this._packedGeometryPoolSize;a++)this._packedGeometries[a]&&this._packedGeometries[a].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),b.prototype.destroy.call(this)},a.prototype.getAttributeBuffer=function(f){var c=(0,e.a9)(Math.ceil(f/8)),d=(0,e.k3)(c),a=8*c;this._aBuffers.length<=d&&(this._iBuffers.length=d+1);var b=this._aBuffers[a];return b||(this._aBuffers[a]=b=new bg(a*this.vertexSize*4)),b},a.prototype.getIndexBuffer=function(d){var c=(0,e.a9)(Math.ceil(d/12)),a=(0,e.k3)(c);this._iBuffers.length<=a&&(this._iBuffers.length=a+1);var b=this._iBuffers[a];return b||(this._iBuffers[a]=b=new Uint16Array(12*c)),b},a.prototype.packInterleavedGeometry=function(b,h,k,c,l){for(var m=h.uint32View,d=h.float32View,n=c/this.vertexSize,i=b.uvs,j=b.indices,f=b.vertexData,o=b._texture.baseTexture._batchLocation,g=Math.min(b.worldAlpha,1),p=g<1&&b._texture.baseTexture.alphaMode?(0,e.rA)(b._tintRGB,g):b._tintRGB+(255*g<<24),a=0;a<f.length;a+=2)d[c++]=f[a],d[c++]=f[a+1],d[c++]=i[a],d[c++]=i[a+1],m[c++]=p,d[c++]=o;for(var a=0;a<j.length;a++)k[l++]=n+j[a]},a._drawCallPool=[],a._textureArrayPool=[],a}(B),bi=function(){function b(b,a){if(this.vertexSrc=b,this.fragTemplate=a,this.programCache={},this.defaultGroupCache={},0>a.indexOf("%count%"))throw Error('Fragment template must contain "%count%".');if(0>a.indexOf("%forloop%"))throw Error('Fragment template must contain "%forloop%".')}return b.prototype.generateShader=function(b){if(!this.programCache[b]){for(var e=new Int32Array(b),c=0;c<b;c++)e[c]=c;this.defaultGroupCache[b]=au.from({uSamplers:e},!0);var d=this.fragTemplate;d=(d=d.replace(/%count%/gi,""+b)).replace(/%forloop%/gi,this.generateSampleSrc(b)),this.programCache[b]=new aU(this.vertexSrc,d)}var f={tint:new Float32Array([1,1,1,1]),translationMatrix:new a.y3,default:this.defaultGroupCache[b]};return new H(this.programCache[b],f)},b.prototype.generateSampleSrc=function(c){var a="";a+="\n",a+="\n";for(var b=0;b<c;b++)b>0&&(a+="\nelse "),b<c-1&&(a+="if(vTextureId < "+b+".5)"),a+="\n{",a+="\n	color = texture2D(uSamplers["+b+"], vTextureCoord);",a+="\n}";return a+="\n",a+="\n"},b}(),bj=function(b){function a(c){void 0===c&&(c=!1);var a=b.call(this)||this;return a._buffer=new am(null,c,!1),a._indexBuffer=new am(null,c,!0),a.addAttribute("aVertexPosition",a._buffer,2,!1,d.vK.FLOAT).addAttribute("aTextureCoord",a._buffer,2,!1,d.vK.FLOAT).addAttribute("aColor",a._buffer,4,!0,d.vK.UNSIGNED_BYTE).addAttribute("aTextureId",a._buffer,1,!0,d.vK.FLOAT).addIndex(a._indexBuffer),a}return aa(a,b),a}(i),bk="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",bl="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",bm=(function(){function a(){}return a.create=function(b){var a=Object.assign({vertex:bk,fragment:bl,geometryClass:bj,vertexSize:6},b),c=a.vertex,d=a.fragment,e=a.vertexSize,f=a.geometryClass;return function(b){function a(g){var a=b.call(this,g)||this;return a.shaderGenerator=new bi(c,d),a.geometryClass=f,a.vertexSize=e,a}return aa(a,b),a}(bh)},Object.defineProperty(a,"defaultVertexSrc",{get:function(){return bk},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultFragmentTemplate",{get:function(){return bl},enumerable:!1,configurable:!0}),a})().create(),bn={},U=function(a){Object.defineProperty(bn,a,{get:function(){return(0,e.a1)("6.0.0","PIXI.systems."+a+" has moved to PIXI."+a),x[a]}})};for(var j in x)U(j);var bo={},V=function(a){Object.defineProperty(bo,a,{get:function(){return(0,e.a1)("6.0.0","PIXI.resources."+a+" has moved to PIXI."+a),S[a]}})};for(var j in S)V(j)}}])